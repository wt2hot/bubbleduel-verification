<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BloxyX - Gaming Website</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        // Custom Tailwind CSS configuration to extend default colors
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'blackest-night': '#0D0D10', // Updated to be lighter for main background
                        'eclipse': '#15161B',      // Updated to be slightly lighter than new blackest-night
                        'off-white': '#F1F1F1',    // Keeping this for white text
                        'steel-mist': '#8A8D99',
                        'sky-pulse': '#3C60FF',
                        'cyber-candy': '#C040FF',
                        'neon-aura': '#6A8FFF',
                        'pulse-pink': '#E060FF',
                        'border-dark': '#0A0A0C', // Adjusted to be darker than new blackest-night
                        'chat-card-bg': '#0D0E13', // A new slightly lighter dark background for chat cards
                    }
                }
            }
        }
    </script>
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        /* Define CSS variables for colors to be used in animations */
        :root {
            --sky-pulse-color: #3C60FF;
            --cyber-candy-color: #C040FF;
            --neon-aura-color: #6A8FFF;
            --pulse-pink-color: #E060FF;
        }

        /* Custom scrollbar for the chat */
        .chat-scroll-area::-webkit-scrollbar {
            width: 8px;
        }

        .chat-scroll-area::-webkit-scrollbar-track {
            background: #08080E; /* Blackest Night for the track */
            border-radius: 10px;
        }

        .chat-scroll-area::-webkit-scrollbar-thumb {
            background: #101116; /* Eclipse for the thumb */
            border-radius: 10px;
        }

        .chat-scroll-area::-webkit-scrollbar-thumb:hover {
            background: #333333; /* Slightly lighter grey on hover */
        }

        /* Inter font from Google Fonts */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #0D0D10; /* Changed to a lighter dark color */
        }

        /* Custom styling for live feed rows to act as cards */
        .live-feed-row {
            border-radius: 0.5rem; /* rounded-lg */
            margin-bottom: 0.75rem; /* space-y-3 between rows */
            padding: 1rem 1.5rem; /* py-4 px-6 equivalent, adjusted for card feel */
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .live-feed-row:nth-child(odd) {
            background-color: rgba(60, 96, 255, 0.15); /* sky-pulse with opacity */
        }
        .live-feed-row:nth-child(even) {
            background-color: rgba(192, 64, 255, 0.15); /* cyber-candy with opacity */
        }
        .live-feed-row:last-child {
            margin-bottom: 0; /* No margin after the last row */
        }

        /* Custom styling for chat messages to act as cards */
        .chat-message-card {
            background-color: #0D0E13; /* Using the new chat-card-bg color */
            border-radius: 0.5rem; /* rounded-lg */
            padding: 0.75rem 1rem; /* Adjusted padding for chat messages */
            display: flex;
            flex-direction: column; /* Stack content vertically */
            border: 1px solid rgba(138, 141, 153, 0.2); /* steel-mist with opacity for stroke */
            position: relative; /* Needed for absolute positioning of timestamp */
        }

        /* Fixed size for chat avatars */
        .chat-avatar {
            width: 40px; /* Set a fixed width */
            height: 40px; /* Set a fixed height */
            object-fit: cover; /* Ensures the image covers the area without distortion */
        }

        /* Animation for the hero section background */
        .hero-background-animated {
            animation: hero-bg-color-fade 8s infinite alternate; /* Longer duration for background */
        }

        @keyframes hero-bg-color-fade {
            0% { background-color: var(--sky-pulse-color); }
            50% { background-color: var(--cyber-candy-color); }
            100% { background-color: var(--sky-pulse-color); }
        }

        /* Pulsing animation for online users indicator */
        @keyframes pulse-animation {
            0% { transform: scale(0.8); opacity: 0.7; }
            50% { transform: scale(1.1); opacity: 1; }
            100% { transform: scale(0.8); opacity: 0.7; }
        }

        .online-users-pulse {
            animation: pulse-animation 1.5s infinite ease-in-out;
        }

        /* Modal specific styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .modal-content {
            background-color: #101116; /* Eclipse */
            padding: 2rem;
            border-radius: 1rem;
            box-shadow: 0px 8px 25px rgba(0, 0, 0, 0.7);
            max-width: 500px;
            width: 90%;
            border: 1px solid #3C60FF; /* Sky Pulse border */
        }

        /* Confirmation modal specific styles */
        .confirmation-modal-content {
            background-color: #1A1A2E; /* Darker background for the modal */
            padding: 2rem;
            border-radius: 1rem;
            box-shadow: 0px 8px 25px rgba(0, 0, 0, 0.7);
            max-width: 400px;
            width: 90%;
            text-align: center;
            position: relative;
            border: 1px solid #3C60FF; /* Sky Pulse border */
        }
        .confirmation-modal-icon {
            color: #3C60FF; /* Sky Pulse color for the icon */
            font-size: 3rem;
            margin-bottom: 1.5rem;
        }
        .confirmation-modal-title {
            color: #F1F1F1; /* Off-white for title */
            font-size: 1.75rem;
            font-weight: bold;
            margin-bottom: 1rem;
        }
        .confirmation-modal-message {
            color: #8A8D99; /* Steel mist for message */
            font-size: 1rem;
            margin-bottom: 2rem;
        }
        .confirmation-modal-button {
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            font-weight: bold;
            transition: background-color 0.3s ease;
        }
        .confirmation-modal-button.primary {
            background-color: #6A8FFF; /* Neon Aura for primary button */
            color: #F1F1F1;
        }
        .confirmation-modal-button.primary:hover {
            background-color: #3C60FF; /* Darker Sky Pulse on hover */
        }
        .confirmation-modal-button.secondary {
            background-color: #2D2D44; /* A slightly lighter dark for secondary button */
            color: #F1F1F1;
            border: 1px solid #8A8D99;
        }
        .confirmation-modal-button.secondary:hover {
            background-color: #3A3A55; /* Even lighter dark on hover */
        }
        .confirmation-modal-close {
            position: absolute;
            top: 1rem;
            right: 1rem;
            color: #8A8D99;
            font-size: 1.5rem;
            cursor: pointer;
        }

        /* Coinflip specific styles */
        .coin-side-button {
            background-color: #0D0D10; /* blackest-night */
        }
        .coin-side-button.selected-heads {
            border-color: #3C60FF; /* sky-pulse */
            box-shadow: 0 0 15px rgba(60, 96, 255, 0.5); /* glow effect */
        }
        .coin-side-button.selected-tails {
            border-color: #C040FF; /* cyber-candy */
            box-shadow: 0 0 15px rgba(192, 64, 255, 0.5); /* glow effect */
        }

        /* Updated coinflip game card styles to match the new image */
        .coinflip-game-card {
            background-color: #15161B; /* eclipse */
            border-radius: 0.75rem;
            padding: 0.75rem 1.25rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border: 1px solid #0A0A0C; /* border-dark */
            transition: all 0.2s ease;
            margin-bottom: 0.5rem; /* Space between cards */
        }
        .coinflip-game-card:hover {
            background-color: #1A1B20; /* Slightly darker on hover */
            border-color: #3C60FF; /* sky-pulse */
        }
        .coinflip-game-card .player-vs-player {
            display: flex;
            align-items: center;
            flex-shrink: 0;
            width: 25%; /* Adjusted width for player info */
        }
        .coinflip-game-card .player-avatar-container {
            position: relative;
            width: 60px; /* Avatar size */
            height: 60px;
            border-radius: 50%;
            border: 2px solid rgba(138, 141, 153, 0.2); /* Light stroke */
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer; /* Make avatar clickable */
        }
        .coinflip-game-card .player-avatar-container.opponent-placeholder {
            cursor: default; /* No pointer for placeholder */
        }
        .coinflip-game-card .player-avatar-container.opponent-placeholder .player-avatar {
            background-color: #15161B; /* Eclipse background for blank avatar */
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem; /* Size for question mark */
            color: #8A8D99; /* Steel mist for question mark */
        }
        .coinflip-game-card .player-avatar {
            width: 52px; /* Inner avatar size */
            height: 52px;
            border-radius: 50%;
            object-fit: cover;
        }
        .coinflip-game-card .coin-overlay {
            position: absolute;
            top: -5px; /* Adjust as needed */
            right: -5px; /* Adjust as needed */
            width: 24px; /* Coin overlay size */
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
            font-weight: bold;
            color: #F1F1F1;
            border: 1px solid #0A0A0C; /* Dark border for coin */
        }
        .coinflip-game-card .coin-overlay.heads {
            background-color: #3C60FF; /* sky-pulse */
        }
        .coinflip-game-card .coin-overlay.tails {
            background-color: #C040FF; /* cyber-candy */
        }
        .coinflip-game-card .vs-text {
            margin: 0 1rem;
            font-weight: bold;
            color: #8A8D99; /* steel-mist */
        }

        .coinflip-game-card .item-display {
            display: flex;
            flex-wrap: wrap; /* Allow items to wrap */
            width: 30%; /* Space for items */
            align-items: flex-start; /* Align items to the top */
            justify-content: center; /* Center items horizontally */
        }
        .coinflip-game-card .item-wrapper {
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 0.25rem; /* Space between item wrappers */
        }
        .coinflip-game-card .item-image {
            width: 64px; /* Larger item image size */
            height: 64px;
            border-radius: 0.5rem;
            object-fit: cover;
            border: 1px solid rgba(138, 141, 153, 0.2); /* Light stroke */
        }
        .coinflip-game-card .item-image.blurred {
            filter: blur(4px); /* Apply blur effect */
        }
        .coinflip-game-card .item-overlay-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #F1F1F1;
            font-weight: bold;
            font-size: 1.25rem;
            z-index: 2;
        }
        .coinflip-game-card .item-bet-range {
            font-size: 0.875rem; /* Slightly larger font */
            color: #steel-mist;
            margin-top: 0.25rem; /* More space below image */
            font-weight: 600; /* Bolder */
            white-space: nowrap; /* Prevent range from wrapping */
        }
        .coinflip-game-card .item-tooltip {
            position: absolute;
            bottom: 100%; /* Position above the image */
            left: 50%;
            transform: translateX(-50%);
            background-color: rgba(0, 0, 0, 0.8);
            color: #F1F1F1;
            padding: 0.25rem 0.5rem;
            border-radius: 0.25rem;
            font-size: 0.75rem;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.2s, visibility 0.2s;
            z-index: 10;
            margin-bottom: 5px; /* Space between tooltip and image */
        }
        .coinflip-game-card .item-wrapper:hover .item-tooltip {
            opacity: 1;
            visibility: visible;
        }

        .coinflip-game-card .bet-value {
            width: 15%; /* Space for bet value */
            text-align: right;
            font-size: 1.25rem;
            font-weight: bold;
            color: #F1F1F1;
        }
        /* Styling for the View/Join buttons */
        .coinflip-game-card .action-buttons-container {
            flex-shrink: 0;
            width: 15%; /* Space for action buttons */
            display: flex;
            flex-direction: column;
            gap: 0.4rem; /* Slightly more space between buttons */
            align-items: center;
        }
        .coinflip-game-card .action-button {
            width: 100%; /* Make buttons fill container */
            padding: 0.75rem 0.6rem; /* Taller padding */
            border-radius: 0.4rem; /* Slightly smaller border-radius */
            font-weight: 600;
            transition: all 0.2s ease; /* Smooth transition for all properties */
            text-align: center;
            font-size: 0.875rem; /* Smaller font size */
        }
        /* Join button gradient animation */
        .coinflip-game-card .action-button.join {
            background: linear-gradient(90deg, var(--sky-pulse-color) 0%, var(--cyber-candy-color) 100%);
            color: #F1F1F1;
            position: relative;
            overflow: hidden;
            z-index: 1;
        }

        .coinflip-game-card .action-button.join::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: all 0.5s ease;
            z-index: -1;
        }

        .coinflip-game-card .action-button.join:hover::before {
            left: 100%;
        }

        .coinflip-game-card .action-button.join:hover {
            filter: brightness(1.1); /* Slightly brighter on hover */
            box-shadow: 0 0 10px rgba(60, 96, 255, 0.5); /* Subtle glow */
        }

        .coinflip-game-card .action-button.view {
            background-color: #0D0D10; /* blackest-night */
            color: #8A8D99; /* steel-mist */
            border: 1px solid #2D2D44; /* darker steel-mist */
        }
        .coinflip-game-card .action-button.view:hover {
            background-color: #1A1B20; /* Slightly darker on hover */
            border-color: #3C60FF; /* sky-pulse */
        }
        .coinflip-game-card .lock-icon {
            color: #8A8D99; /* steel-mist */
            font-size: 1.5rem;
            text-align: center;
            width: 15%;
        }

        /* Filter bar styles (updated to match new image) */
        .filter-bar {
            background-color: #15161B; /* eclipse */
            border-radius: 0.75rem;
            padding: 0.75rem 1.5rem; /* Adjusted padding */
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: 1px solid #0A0A0C;
            margin-bottom: 1.5rem;
        }
        .filter-bar .stats-container { /* New container for the three stat items */
            display: flex;
            flex: 1;
            justify-content: space-around; /* Distribute space evenly */
            align-items: center;
            gap: 1rem; /* Space between the individual stat boxes */
            margin-right: 1.5rem; /* Space between stats and button group */
        }
        .filter-bar .stats-item-wrapper { /* New wrapper for individual stat items */
            background-color: #0D0D10; /* blackest-night for individual items */
            border-radius: 0.5rem; /* Rounded corners for each item */
            padding: 0.75rem 1rem; /* Padding inside each item */
            border: 1px solid rgba(138, 141, 153, 0.2); /* Light stroke */
            display: flex; /* Make it a flex container */
            align-items: center; /* Align items vertically in the middle */
            justify-content: center; /* Center content horizontally */
            flex-grow: 1; /* Allow items to grow and fill space */
            min-width: 120px; /* Minimum width for each stat box */
        }

        .filter-bar .stats-item { /* Original stats-item class, now inside wrapper */
            display: flex;
            flex-direction: row; /* Changed to row for number and text side-by-side */
            align-items: baseline; /* Align items to the baseline for number and text */
            color: #F1F1F1; /* Changed text color to off-white */
            font-weight: bold; /* Make text bold */
            font-size: 1.25rem; /* Same font size as number */
            white-space: nowrap; /* Prevent wrapping */
        }
        .filter-bar .stats-item span:first-child {
            color: #F1F1F1; /* Ensure number is off-white */
            font-size: 1.25rem; /* Ensure number is same size */
            font-weight: bold; /* Ensure number is bold */
            margin-right: 0.5rem; /* Space between number and text */
        }
        .filter-bar .stats-item span:last-child {
            color: #8A8D99; /* Steel mist for the label text */
            font-size: 1rem; /* Slightly smaller for the label, adjust as needed */
            font-weight: 600; /* Bolder for the label */
        }

        .filter-bar .button-group {
            display: flex;
            align-items: center;
            margin-right: 1.5rem; /* Space between button group and stats */
        }
        .filter-bar .button-group button {
            padding: 0.5rem 1.25rem;
            border-radius: 0.5rem;
            font-weight: 600;
            transition: background-color 0.2s ease;
            margin-right: 0.5rem; /* Space between buttons */
            min-width: 100px; /* Ensure consistent size for Create/History */
            justify-content: center; /* Center text in buttons */
        }
        .filter-bar .button-group button:last-child {
            margin-right: 0; /* No margin after the last button */
        }
        .filter-bar .button-group button.active {
            background-color: #3C60FF; /* sky-pulse */
            color: #F1F1F1;
        }
        .filter-bar .button-group button:not(.active) {
            background-color: #0D0D10; /* blackest-night */
            color: #8A8D99; /* steel-mist */
            border: 1px solid #2D2D44; /* darker steel-mist */
        }
        .filter-bar .filter-controls {
            display: flex;
            align-items: center;
            gap: 1rem; /* Use gap for spacing between filter controls */
        }

        /* Custom Dropdown Styles */
        .custom-dropdown {
            position: relative;
            display: inline-block; /* Allows side-by-side with other elements */
        }

        .custom-dropdown-toggle {
            background-color: #15161B; /* eclipse */
            border: none; /* Removed border for solid look */
            border-radius: 0.5rem;
            padding: 0.5rem 0.75rem;
            color: #F1F1F1;
            font-size: 0.875rem;
            cursor: pointer;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: space-between;
            min-width: 150px; /* Ensure enough width for text and arrow */
            font-weight: 600; /* Bolder text for the toggle */
            height: 42px; /* Match height of buttons */
        }

        .custom-dropdown-toggle i {
            margin-left: 0.75rem;
            transition: transform 0.3s ease;
        }

        .custom-dropdown-toggle.active i {
            transform: rotate(180deg);
        }

        .custom-dropdown-menu {
            position: absolute;
            background-color: #15161B; /* eclipse */
            border-radius: 0.5rem;
            box-shadow: 0px 4px 15px rgba(0, 0, 0, 0.5);
            padding: 0.5rem 0;
            top: calc(100% + 0.5rem); /* Position below the toggle button with some spacing */
            left: 0;
            right: 0;
            z-index: 20; /* Ensure it's above other content */
            border: 1px solid #0A0A0C; /* border-dark */
            overflow: hidden; /* Ensure rounded corners clip content */
        }

        .custom-dropdown-item {
            padding: 0.75rem 1rem; /* Increased padding */
            color: #F1F1F1;
            font-size: 0.875rem;
            cursor: pointer;
            transition: background-color 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: space-between;
            font-weight: 600; /* Bolder text for items */
        }

        .custom-dropdown-item:hover {
            background-color: #0A0A0C; /* border-dark, slightly darker hover */
        }

        .custom-dropdown-item.selected {
            background-color: #3C60FF; /* sky-pulse */
            color: #F1F1F1;
        }

        /* Player Profile Modal Styles */
        .player-profile-modal-content {
            background-color: #1A1A2E; /* Darker background for the modal */
            padding: 2rem;
            border-radius: 1rem;
            box-shadow: 0px 8px 25px rgba(0, 0, 0, 0.7);
            max-width: 500px;
            width: 90%;
            text-align: center;
            position: relative;
            border: 1px solid #C040FF; /* Cyber Candy border */
            display: flex;
            flex-direction: column;
            animation: modal-glow 1.5s infinite alternate; /* Cool animation */
        }

        @keyframes modal-glow {
            0% { box-shadow: 0px 8px 25px rgba(0, 0, 0, 0.7), 0 0 5px var(--pulse-pink-color); }
            50% { box-shadow: 0px 8px 25px rgba(0, 0, 0, 0.7), 0 0 15px var(--pulse-pink-color); }
            100% { box-shadow: 0px 8px 25px rgba(0, 0, 0, 0.7), 0 0 5px var(--pulse-pink-color); }
        }

        .player-profile-modal-close {
            position: absolute;
            top: 1rem;
            right: 1rem;
            color: #8A8D99;
            font-size: 1.5rem;
            cursor: pointer;
        }
        .player-profile-avatar-container {
            position: relative;
            width: 140px;
            height: 140px;
            border-radius: 50%;
            border: 3px solid #6A8FFF; /* Neon Aura border */
            display: flex;
            align-items: center;
            justify-content: center;
            margin-top: 2rem;
            margin-bottom: 1.5rem;
            margin-left: auto;
            margin-right: auto;
        }
        .player-profile-avatar {
            width: 128px;
            height: 128px;
            border-radius: 50%;
            object-fit: cover;
        }
        .player-profile-level {
            position: absolute;
            bottom: -15px; /* Adjusted to be more below the avatar */
            left: 50%;
            transform: translateX(-50%);
            background-color: #C040FF; /* Cyber Candy */
            color: #F1F1F1;
            padding: 0.2rem 0.6rem;
            border-radius: 0.5rem;
            font-size: 0.75rem;
            font-weight: bold;
            white-space: nowrap;
            text-align: center; /* Align level text */
        }
        .player-profile-username {
            color: #F1F1F1;
            font-size: 2.25rem; /* Larger font size */
            font-weight: 800; /* Bolder */
            margin-top: 1.5rem; /* Space from level tag */
            margin-bottom: 0.25rem;
        }
        .player-profile-tag {
            background-color: #0D0D10; /* Blackest Night */
            color: #8A8D99; /* Steel Mist */
            padding: 0.25rem 0.75rem;
            border-radius: 0.5rem;
            font-size: 1rem; /* Larger font size */
            font-weight: 600; /* Bolder */
            margin-bottom: 2rem; /* Space below the tag */
            display: inline-block; /* To center it */
        }
        .player-stats-heading {
            color: #F1F1F1;
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 1.5rem;
            text-align: center;
            width: 100%;
        }
        .player-stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
            width: 100%;
            margin-bottom: 2rem;
        }
        .player-stat-card {
            background-color: #0D0E13; /* Chat card bg */
            border-radius: 0.75rem;
            padding: 1rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            border: 1px solid rgba(138, 141, 153, 0.2);
        }
        .player-stat-card .icon {
            font-size: 1.5rem;
            color: #C040FF; /* Cyber Candy */
            margin-bottom: 0.5rem;
        }
        .player-stat-card .value {
            color: #F1F1F1;
            font-size: 1.5rem;
            font-weight: bold;
        }
        .player-stat-card .label {
            color: #8A8D99;
            font-size: 0.875rem;
            font-weight: 500;
            text-transform: uppercase;
        }
        .player-profile-modal-button {
            background-color: #6A8FFF; /* Neon Aura */
            color: #F1F1F1;
            padding: 0.75rem 2rem;
            border-radius: 0.5rem;
            font-weight: bold;
            transition: background-color 0.3s ease;
            width: 100%;
        }
        .player-profile-modal-button:hover {
            background-color: #3C60FF; /* Sky Pulse */
        }

        /* Game Details Modal Styles */
        .game-details-modal-content {
            background-color: #1A1A2E; /* Darker background for the modal */
            padding: 2rem;
            border-radius: 1rem;
            box-shadow: 0px 8px 25px rgba(0, 0, 0, 0.7);
            max-width: 800px; /* Wider for game details */
            width: 90%;
            position: relative;
            border: 1px solid #6A8FFF; /* Neon Aura border */
            display: flex;
            flex-direction: column;
            animation: modal-glow-blue 1.5s infinite alternate;
        }

        @keyframes modal-glow-blue {
            0% { box-shadow: 0px 8px 25px rgba(0, 0, 0, 0.7), 0 0 5px var(--neon-aura-color); }
            50% { box-shadow: 0px 8px 25px rgba(0, 0, 0, 0.7), 0 0 15px var(--neon-aura-color); }
            100% { box-shadow: 0px 8px 25px rgba(0, 0, 0, 0.7), 0 0 5px var(--neon-aura-color); }
        }

        .game-details-players {
            display: flex;
            justify-content: space-around;
            align-items: center;
            margin-bottom: 2rem;
            padding-bottom: 1.5rem;
            border-bottom: 1px solid rgba(138, 141, 153, 0.2);
        }
        .game-details-player-card {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            flex: 1; /* Distribute space */
        }
        .game-details-player-avatar-container {
            position: relative;
            width: 100px;
            height: 100px;
            border-radius: 50%;
            border: 2px solid #8A8D99; /* Steel mist border */
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 0.75rem;
        }
        .game-details-player-avatar {
            width: 90px;
            height: 90px;
            border-radius: 50%;
            object-fit: cover;
        }
        .game-details-coin-overlay {
            position: absolute;
            bottom: -5px;
            right: -5px;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
            font-weight: bold;
            color: #F1F1F1;
            border: 1px solid #0A0A0C;
        }
        .game-details-coin-overlay.heads { background-color: #3C60FF; }
        .game-details-coin-overlay.tails { background-color: #C040FF; }
        .game-details-username {
            color: #F1F1F1;
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
        }
        .game-details-bet-value {
            color: #F1F1F1;
            font-size: 1.25rem;
            font-weight: 600;
            display: flex;
            align-items: center;
        }
        .game-details-bet-value i {
            color: #sky-pulse;
            margin-right: 0.5rem;
        }
        .game-details-vs {
            color: #8A8D99;
            font-size: 2rem;
            font-weight: bold;
            margin: 0 1rem;
        }

        .game-details-items-section {
            display: flex;
            justify-content: space-around;
            gap: 2rem;
            margin-bottom: 2rem;
        }
        .game-details-items-column {
            flex: 1;
            background-color: #0D0E13; /* chat-card-bg */
            border-radius: 0.75rem;
            padding: 1rem;
            border: 1px solid rgba(138, 141, 153, 0.2);
            max-height: 250px; /* Fixed height for scrollability */
            overflow-y: auto; /* Enable vertical scrolling */
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .game-details-items-column::-webkit-scrollbar {
            width: 6px;
        }
        .game-details-items-column::-webkit-scrollbar-track {
            background: #08080E;
            border-radius: 10px;
        }
        .game-details-items-column::-webkit-scrollbar-thumb {
            background: #101116;
            border-radius: 10px;
        }
        .game-details-items-column::-webkit-scrollbar-thumb:hover {
            background: #333333;
        }

        .game-details-items-column h4 {
            color: #F1F1F1;
            font-size: 1.25rem;
            font-weight: bold;
            margin-bottom: 1rem;
            text-align: center;
            width: 100%;
        }
        .game-details-item {
            display: flex;
            align-items: center;
            margin-bottom: 0.75rem;
            background-color: #15161B; /* eclipse */
            border-radius: 0.5rem;
            padding: 0.5rem 0.75rem;
            width: 100%; /* Full width within column */
            border: 1px solid #0A0A0C;
        }
        .game-details-item img {
            width: 48px;
            height: 48px;
            border-radius: 0.25rem;
            object-fit: cover;
            margin-right: 0.75rem;
            border: 1px solid rgba(138, 141, 153, 0.2);
        }
        .game-details-item-info {
            flex-grow: 1;
        }
        .game-details-item-name {
            color: #F1F1F1;
            font-weight: 600;
            font-size: 0.95rem;
        }
        .game-details-item-value {
            color: #8A8D99;
            font-size: 0.85rem;
            display: flex;
            align-items: center;
        }
        .game-details-item-value i {
            color: #sky-pulse;
            margin-right: 0.25rem;
            font-size: 0.75rem;
        }

        .game-details-fairness-button {
            background-color: #C040FF; /* Cyber Candy */
            color: #F1F1F1;
            padding: 0.75rem 2rem;
            border-radius: 0.5rem;
            font-weight: bold;
            transition: background-color 0.3s ease;
            width: 100%;
            margin-top: 1rem;
        }
        .game-details-fairness-button:hover {
            background-color: #E060FF; /* Pulse Pink */
        }

        /* Fairness Modal Styles */
        .fairness-modal-content {
            background-color: #1A1A2E; /* Darker background for the modal */
            padding: 2rem;
            border-radius: 1rem;
            box-shadow: 0px 8px 25px rgba(0, 0, 0, 0.7);
            max-width: 600px;
            width: 90%;
            position: relative;
            border: 1px solid #E060FF; /* Pulse Pink border */
            display: flex;
            flex-direction: column;
            animation: modal-glow-pink 1.5s infinite alternate;
        }

        @keyframes modal-glow-pink {
            0% { box-shadow: 0px 8px 25px rgba(0, 0, 0, 0.7), 0 0 5px var(--pulse-pink-color); }
            50% { box-shadow: 0px 8px 25px rgba(0, 0, 0, 0.7), 0 0 15px var(--pulse-pink-color); }
            100% { box-shadow: 0px 8px 25px rgba(0, 0, 0, 0.7), 0 0 5px var(--pulse-pink-color); }
        }

        .fairness-modal-content h3 {
            color: #F1F1F1;
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 2rem;
            text-align: center;
        }
        .fairness-seed-item {
            background-color: #0D0E13; /* chat-card-bg */
            border-radius: 0.75rem;
            padding: 1rem;
            margin-bottom: 1rem;
            border: 1px solid rgba(138, 141, 153, 0.2);
            display: flex;
            flex-direction: column;
        }
        .fairness-seed-item label {
            color: #8A8D99;
            font-size: 0.9rem;
            font-weight: 500;
            margin-bottom: 0.5rem;
            text-transform: uppercase;
        }
        .fairness-seed-input-group {
            display: flex;
            align-items: center;
        }
        .fairness-seed-input {
            background-color: transparent;
            border: none;
            color: #F1F1F1;
            font-size: 1rem;
            flex-grow: 1;
            outline: none;
            cursor: text;
            padding: 0;
            white-space: nowrap; /* Prevent text from wrapping */
            overflow: hidden; /* Hide overflow */
            text-overflow: ellipsis; /* Add ellipsis for overflow */
        }
        .fairness-copy-button {
            background-color: #3C60FF; /* Sky Pulse */
            color: #F1F1F1;
            padding: 0.5rem 0.75rem;
            border-radius: 0.5rem;
            font-size: 0.9rem;
            font-weight: bold;
            margin-left: 1rem;
            transition: background-color 0.3s ease;
        }
        .fairness-copy-button:hover {
            background-color: #6A8FFF; /* Neon Aura */
        }
        .fairness-modal-close {
            position: absolute;
            top: 1rem;
            right: 1rem;
            color: #8A8D99;
            font-size: 1.5rem;
            cursor: pointer;
        }

        /* Create/Join Game Modal Styles (reused for both) */
        .item-selection-modal-content {
            background-color: #1A1A2E; /* Darker background for the modal */
            padding: 2rem;
            border-radius: 1rem;
            box-shadow: 0px 8px 25px rgba(0, 0, 0, 0.7);
            max-width: 900px; /* Wider for item grid */
            width: 90%;
            position: relative;
            border: 1px solid #C040FF; /* Cyber Candy border */
            display: flex;
            flex-direction: column;
            animation: modal-glow 1.5s infinite alternate;
        }
        .item-selection-modal-content .filter-bar {
            background-color: #0D0D10; /* blackest-night */
            border: 1px solid rgba(138, 141, 153, 0.2);
            margin-bottom: 1.5rem;
            padding: 0.5rem 1rem;
        }
        .item-selection-modal-content .filter-bar .search-input {
            background-color: transparent;
            border: none;
            color: #F1F1F1;
            font-size: 1rem;
            padding: 0.5rem;
            outline: none;
            flex-grow: 1;
        }
        .item-selection-modal-content .filter-bar .search-icon {
            color: #8A8D99;
            margin-left: 0.5rem;
        }
        .item-selection-modal-content .filter-bar .custom-dropdown-toggle {
            background-color: #15161B;
            border: 1px solid rgba(138, 141, 153, 0.2);
            height: auto; /* Allow height to adjust */
            padding: 0.5rem 0.75rem;
        }
        .item-selection-modal-content .filter-bar .custom-dropdown-menu {
            background-color: #15161B;
            border: 1px solid rgba(138, 141, 153, 0.2);
        }

        .pets-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr)); /* Adjust item size */
            gap: 1rem;
            padding: 1rem;
            background-color: #0D0E13; /* chat-card-bg */
            border-radius: 0.75rem;
            border: 1px solid rgba(138, 141, 153, 0.2);
            overflow-y: auto;
            max-height: 400px; /* Limit height for scrollability */
            margin-bottom: 1.5rem;
        }
        .pets-grid::-webkit-scrollbar {
            width: 8px;
        }
        .pets-grid::-webkit-scrollbar-track {
            background: #08080E;
            border-radius: 10px;
        }
        .pets-grid::-webkit-scrollbar-thumb {
            background: #101116;
            border-radius: 10px;
        }
        .pets-grid::-webkit-scrollbar-thumb:hover {
            background: #333333;
        }

        .pet-item-card {
            background-color: #15161B; /* eclipse */
            border-radius: 0.75rem;
            padding: 0.75rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            border: 1px solid #0A0A0C;
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
        }
        .pet-item-card:hover {
            background-color: #1A1B20;
            border-color: #3C60FF;
            box-shadow: 0 0 8px rgba(60, 96, 255, 0.3);
        }
        .pet-item-card.selected {
            border-color: #C040FF; /* cyber-candy */
            box-shadow: 0 0 12px rgba(192, 64, 255, 0.5);
            background-color: #251B2E; /* Slightly different background for selected */
        }
        .pet-item-card img {
            width: 80px; /* Larger image size */
            height: 80px;
            border-radius: 0.5rem;
            object-fit: cover;
            margin-bottom: 0.5rem;
        }
        .pet-item-card .item-name {
            color: #F1F1F1;
            font-weight: 600;
            font-size: 0.9rem;
            text-align: center;
            margin-bottom: 0.25rem;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            width: 100%;
        }
        .pet-item-card .item-value {
            color: #8A8D99;
            font-size: 0.8rem;
            display: flex;
            align-items: center;
            font-weight: 500;
        }
        .pet-item-card .item-value i {
            color: #sky-pulse;
            margin-right: 0.25rem;
            font-size: 0.7rem;
        }
        .pet-item-card .selection-overlay {
            position: absolute;
            top: 5px;
            right: 5px;
            background-color: #C040FF;
            color: #F1F1F1;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
            font-weight: bold;
        }
        .item-selection-modal-buttons {
            display: flex;
            justify-content: space-between;
            gap: 1rem;
        }
        .item-selection-modal-buttons button {
            flex: 1;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            font-weight: bold;
            transition: background-color 0.3s ease;
            font-size: 1rem;
        }
        .item-selection-modal-buttons .deposit-button {
            background-color: #3C60FF; /* sky-pulse */
            color: #F1F1F1;
        }
        .item-selection-modal-buttons .deposit-button:hover {
            background-color: #6A8FFF; /* neon-aura */
        }
        .item-selection-modal-buttons .action-button { /* For Create or Join */
            background-color: #C040FF; /* cyber-candy */
            color: #F1F1F1;
        }
        .item-selection-modal-buttons .action-button:hover {
            background-color: #E060FF; /* pulse-pink */
        }
        .item-selection-modal-total-value {
            background-color: #0D0D10; /* blackest-night */
            border-radius: 0.75rem;
            padding: 0.75rem 1.5rem;
            margin-bottom: 1.5rem;
            text-align: center;
            color: #F1F1F1;
            font-size: 1.5rem;
            font-weight: bold;
            border: 1px solid rgba(138, 141, 153, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }
        .item-selection-modal-total-value i {
            color: #sky-pulse;
        }
        .item-selection-modal-bet-range {
            color: #8A8D99;
            font-size: 1rem;
            margin-bottom: 1rem;
            text-align: center;
        }
        /* Coin side selection for creator */
        .coin-side-selection {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }
        .coin-side-selection .coin-option {
            background-color: #0D0D10;
            color: #8A8D99;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            border: 1px solid rgba(138, 141, 153, 0.2);
            cursor: pointer;
            font-weight: bold;
            transition: all 0.2s ease;
        }
        .coin-side-selection .coin-option.selected {
            background-color: #3C60FF;
            color: #F1F1F1;
            border-color: #3C60FF;
            box-shadow: 0 0 10px rgba(60, 96, 255, 0.5);
        }
        .coin-side-selection .coin-option:hover:not(.selected) {
            background-color: #1A1B20;
            border-color: #6A8FFF;
        }
        /* Game Details Win Probability */
        .game-details-win-probability {
            display: flex;
            justify-content: space-around;
            align-items: center;
            width: 100%;
            margin-top: 1.5rem;
            padding-top: 1.5rem;
            border-top: 1px solid rgba(138, 141, 153, 0.2);
        }
        .game-details-win-probability .probability-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
        }
        .game-details-win-probability .probability-item .value {
            font-size: 1.75rem;
            font-weight: bold;
            color: #F1F1F1;
        }
        .game-details-win-probability .probability-item .label {
            font-size: 0.9rem;
            color: #8A8D99;
            text-transform: uppercase;
        }
        .game-details-win-probability .probability-item.heads .value {
            color: #3C60FF; /* Sky Pulse for Heads */
        }
        .game-details-win-probability .probability-item.tails .value {
            color: #C040FF; /* Cyber Candy for Tails */
        }

        /* Wallet component specific styles */
        .wallet-card {
            background-color: #15161B; /* eclipse */
            border-radius: 1rem;
            box-shadow: 0px 8px 25px rgba(0, 0, 0, 0.7);
            border: 1px solid #0A0A0C; /* border-dark */
            padding: 1.5rem; /* Reduced padding */
            width: 100%;
            max-width: 600px; /* Smaller max-width for the component */
            min-height: 500px; /* Adjusted min-height */
            display: flex;
            flex-direction: column;
        }

        .wallet-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem; /* Adjusted margin */
        }
        .wallet-header h1 {
            font-size: 2.25rem; /* Adjusted font size */
            color: #F1F1F1;
            font-weight: 800;
        }
        .wallet-header i {
            font-size: 1.25rem; /* Adjusted icon size */
            color: #8A8D99;
            cursor: pointer;
            transition: color 0.2s ease;
        }

        .input-group {
            position: relative;
        }

        .input-group input {
            padding-right: 2.5rem; /* Space for icon */
        }

        .input-group .icon {
            position: absolute;
            right: 0.75rem;
            top: 50%;
            transform: translateY(-50%);
            color: #8A8D99;
        }

        /* Dropdown specific styles */
        .dropdown-container {
            position: relative;
            display: inline-block;
        }

        .dropdown-button {
            background-color: #0D0D10; /* blackest-night */
            color: #F1F1F1;
            padding: 0.6rem 1rem; /* Adjusted padding */
            border-radius: 0.5rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            cursor: pointer;
            border: 1px solid #2D2D44; /* darker shade for border */
            transition: background-color 0.3s ease;
            font-size: 0.9rem; /* Adjusted font size */
        }

        .dropdown-button:hover {
            background-color: #1A1B20;
        }

        .dropdown-options {
            position: absolute;
            background-color: #0D0D10; /* blackest-night */
            border-radius: 0.5rem;
            box-shadow: 0px 4px 15px rgba(0, 0, 0, 0.5);
            z-index: 10;
            min-width: 100%;
            margin-top: 0.5rem;
            overflow: hidden; /* Ensures rounded corners */
            border: 1px solid #2D2D44;
        }

        .dropdown-options div {
            padding: 0.6rem 1rem; /* Adjusted padding */
            color: #F1F1F1;
            cursor: pointer;
            transition: background-color 0.2s ease;
            font-size: 0.9rem; /* Adjusted font size */
        }

        .dropdown-options div:hover {
            background-color: #1A1B20;
        }

        .dropdown-options.hidden {
            display: none;
        }

        /* Item grid display */
        .item-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); /* Smaller responsive grid */
            gap: 0.75rem; /* Adjusted gap */
            flex-grow: 1; /* Allow grid to take available space */
            overflow-y: auto; /* Enable scrolling if many items */
            padding-right: 0.5rem; /* For scrollbar space */
            margin-bottom: 1rem; /* Space before action buttons */
            max-height: 300px; /* Fixed height for scrollable area (adjust as needed) */
        }

        /* Custom scrollbar for the item grid */
        .item-grid::-webkit-scrollbar {
            width: 8px;
        }

        .item-grid::-webkit-scrollbar-track {
            background: #1A1B20; /* Darker gray for the track */
            border-radius: 10px;
        }

        .item-grid::-webkit-scrollbar-thumb {
            background: #8A8D99; /* Steel mist for the thumb */
            border-radius: 10px;
        }

        .item-grid::-webkit-scrollbar-thumb:hover {
            background: #F1F1F1; /* Off-white on hover */
        }

        .item-grid-item {
            background-color: #0D0D10; /* blackest-night */
            border: 1px solid #2D2D44;
            border-radius: 0.75rem;
            padding: 0.75rem; /* Adjusted padding */
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            cursor: pointer;
            transition: transform 0.2s ease, box-shadow 0.2s ease, border-color 0.2s ease; /* Added border-color transition */
            position: relative; /* For absolute positioning of the large value */
            padding-bottom: 3.5rem; /* Make space for the large value at the bottom */
        }

        .item-grid-item:hover {
            transform: translateY(-3px);
            box-shadow: 0px 5px 15px rgba(0, 0, 0, 0.3);
        }

        .item-grid-item.selected {
            border-color: #C040FF; /* Cyber Candy for selected item border */
            box-shadow: 0px 0px 10px rgba(192, 64, 255, 0.5); /* Glowing effect */
        }

        .item-grid-item img {
            width: 70px; /* Smaller image size */
            height: 70px; /* Smaller image size */
            object-fit: contain;
            margin-bottom: 0.4rem; /* Adjusted margin */
            border-radius: 0.375rem; /* Slightly rounded corners for the image */
        }

        .item-grid-item .item-name {
            font-size: 0.8rem; /* Smaller font size */
            font-weight: 500;
            color: #F1F1F1;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            width: 100%; /* Ensure text ellipsis works */
        }

        .item-grid-item .item-value {
            font-size: 0.75rem; /* Smaller font size */
            color: #C040FF; /* Cyber Candy for gem value */
            display: flex;
            align-items: center;
            position: absolute; /* Position relative to parent for visibility */
            top: 10px; /* Adjust as needed to not overlap with image */
            right: 10px; /* Adjust as needed */
            background-color: #0D0D10; /* Ensure it's on top of other elements */
            padding: 0.2em 0.4em;
            border-radius: 0.3em;
            z-index: 2; /* Ensure it's above the image if needed */
        }

        .item-grid-item .item-value i {
            margin-right: 0.2rem;
            color: #C040FF; /* Cyber Candy for gem icon */
        }

        .item-grid-item .large-value {
            position: absolute;
            bottom: 0; /* Position at the very bottom */
            left: 0;
            right: 0;
            font-size: 1.25rem; /* Adjusted large font size */
            font-weight: bold;
            color: #F1F1F1; /* Off-white color */
            background-color: #0D0D10; /* blackest-night background for the value area */
            padding: 0.5rem 0;
            border-top: 1px solid #2D2D44; /* Separator line */
            border-bottom-left-radius: 0.75rem; /* Match parent border-radius */
            border-bottom-right-radius: 0.75rem; /* Match parent border-radius */
        }

        .action-buttons {
            display: flex;
            justify-content: flex-end; /* Align to right */
            gap: 0.75rem; /* Adjusted gap */
            margin-top: 1rem; /* Adjusted margin between grid and action buttons */
            flex-shrink: 0; /* Prevent buttons from shrinking */
        }

        .action-buttons button {
            background-color: #0D0D10; /* blackest-night */
            color: #F1F1F1;
            padding: 0.6rem 1.2rem; /* Adjusted padding */
            border-radius: 0.5rem;
            border: 1px solid #2D2D44;
            font-weight: 500;
            transition: background-color 0.3s ease;
            font-size: 0.9rem; /* Adjusted font size */
            cursor: pointer;
        }

        .action-buttons button:hover {
            background-color: #1A1B20;
        }

        .action-buttons .deposit-button {
            background-color: #3C60FF; /* sky-pulse */
            border-color: #3C60FF;
        }
        .action-buttons .deposit-button:hover {
            background-color: #6A8FFF; /* neon-aura */
        }

        .action-buttons .withdraw-button {
            background-color: #C040FF; /* cyber-candy */
            border-color: #C040FF;
        }

        .action-buttons .withdraw-button:hover {
            background-color: #E060FF; /* pulse-pink */
        }

        /* Value bar style */
        .value-bar {
            background-color: #0D0D10; /* blackest-night */
            border-radius: 0.75rem;
            border: 1px solid #2D2D44;
            padding: 0.75rem 1rem;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 1rem; /* Space between value bar and item grid */
        }

        .value-bar span {
            font-size: 1.1rem;
            font-weight: bold;
            color: #F1F1F1;
        }

        .value-bar .value-amount {
            color: #C040FF; /* Cyber Candy color for the value */
            margin-left: 0.5rem;
        }

        /* Deposit Modal Styles */
        .deposit-modal-container {
            background-color: #15161B;
            border-radius: 1rem;
            box-shadow: 0px 8px 25px rgba(0, 0, 0, 0.7);
            border: 1px solid #0A0A0C;
            padding: 1.5rem;
            width: 100%;
            max-width: 500px;
            display: flex;
            flex-direction: column;
            position: relative;
            margin: auto;
        }

        .deposit-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }
        .deposit-header h1 {
            font-size: 1.75rem;
            font-weight: 800;
            color: #F1F1F1;
        }
        .deposit-header .close-button {
            font-size: 1.5rem;
            color: #8A8D99;
            cursor: pointer;
            transition: color 0.2s ease;
            background: none;
            border: none;
        }
        .deposit-header .close-button:hover {
            color: #F1F1F1;
        }

        .instructions p {
            font-size: 1rem;
            color: #8A8D99;
            margin-bottom: 1.5rem;
        }

        .instruction-item {
            display: flex;
            align-items: flex-start;
            margin-bottom: 1rem;
        }
        .instruction-number {
            background-color: #3C60FF;
            color: #F1F1F1;
            width: 28px;
            height: 28px;
            border-radius: 9999px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-weight: 700;
            font-size: 0.875rem;
            flex-shrink: 0;
            margin-right: 0.75rem;
        }
        .instruction-text {
            color: #F1F1F1;
            font-size: 1rem;
            line-height: 1.5;
        }

        .bot-list {
            margin-top: 2rem;
            margin-bottom: 2rem;
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .bot-card {
            background-color: #1A1B20;
            border-radius: 0.75rem;
            padding: 1rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border: 1px solid rgba(138, 141, 153, 0.2);
            transition: border-color 0.2s ease;
        }
        .bot-card:hover {
            border-color: #3C60FF;
        }

        .bot-info {
            display: flex;
            align-items: center;
        }
        .bot-avatar {
            width: 50px;
            height: 50px;
            border-radius: 0.5rem;
            margin-right: 1rem;
        }
        .bot-details {
            display: flex;
            flex-direction: column;
        }
        .bot-name {
            font-size: 1.125rem;
            font-weight: 600;
            color: #F1F1F1;
            margin-right: 0.5rem;
        }
        .bot-game {
            font-size: 0.875rem;
            color: #8A8D99;
        }

        .bot-status-container {
            display: flex;
            align-items: center;
            flex-shrink: 0;
        }

        .bot-status-dot {
            width: 10px;
            height: 10px;
            border-radius: 9999px;
            margin-right: 0.25rem;
        }

        .online-dot {
            background-color: #22C55E;
            animation: beep-online 1.5s infinite ease-in-out;
        }

        .offline-dot {
            background-color: #EF4444;
            animation: beep-offline 1.5s infinite ease-in-out;
        }

        .status-text {
            font-size: 0.875rem;
            font-weight: 500;
        }

        .online-text {
            color: #22C55E;
        }

        .offline-text {
            color: #EF4444;
        }

        @keyframes beep-online {
            0% { transform: scale(0.8); opacity: 0.7; }
            50% { transform: scale(1.1); opacity: 1; }
            100% { transform: scale(0.8); opacity: 0.7; }
        }

        @keyframes beep-offline {
            0% { transform: scale(0.8); opacity: 0.7; }
            50% { transform: scale(1.1); opacity: 1; }
            100% { transform: scale(0.8); opacity: 0.7; }
        }

        .join-button {
            background-color: #3C60FF;
            color: #F1F1F1;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            font-weight: 600;
            transition: background-color 0.2s ease;
            border: none;
            cursor: pointer;
        }
        .join-button:hover {
            background-color: #6A8FFF;
        }

        .security-tip {
            background-color: rgba(138, 141, 153, 0.1);
            border-radius: 0.5rem;
            padding: 1rem 1.5rem;
            font-size: 0.875rem;
            color: #8A8D99;
            border: 1px solid rgba(138, 141, 153, 0.2);
            margin-top: 1.5rem;
        }

        .balance-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 2rem;
            padding-top: 1rem;
            border-top: 1px solid #0A0A0C;
        }

        /* Leaderboard Modal Styles */
        .leaderboard-card {
            background-color: #15161B; /* eclipse */
            border-radius: 1rem;
            box-shadow: 0px 8px 25px rgba(0, 0, 0, 0.7);
            border: 1px solid #3C60FF; /* sky-pulse border */
            padding: 2rem;
            width: 90%;
            max-width: 800px;
            max-height: 80vh;
            overflow-y: auto;
        }

        .leaderboard-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .leaderboard-table-header {
            display: flex;
            padding: 0.75rem 0;
            border-bottom: 1px solid #2D2D44;
            margin-bottom: 1rem;
            font-weight: 600;
            color: #8A8D99;
            font-size: 1.1rem;
        }

        .leaderboard-table-header .leaderboard-rank {
            width: 15%;
            text-align: left;
            padding-left: 1rem;
        }

        .leaderboard-table-header .leaderboard-user {
            width: 40%;
            text-align: left;
        }

        .leaderboard-table-header .leaderboard-wager,
        .leaderboard-table-header .leaderboard-profit {
            width: 22.5%;
            text-align: left;
        }

        .leaderboard-row {
            display: flex;
            align-items: center;
            padding: 0.75rem 0;
            border-bottom: 1px solid rgba(138, 141, 153, 0.1);
        }

        .leaderboard-row:last-child {
            border-bottom: none;
        }

        .leaderboard-rank {
            width: 15%;
            font-weight: bold;
            text-align: left;
            font-size: 1.2rem;
            padding-left: 1rem;
        }

        .rank-blue {
            color: #3C60FF;
        }

        .rank-pink {
            color: #C040FF;
        }

        .border-blue {
            border: 2px solid #3C60FF;
        }

        .border-pink {
            border: 2px solid #C040FF;
        }

        .leaderboard-user {
            width: 40%;
            display: flex;
            align-items: center;
            font-size: 1.1rem;
        }

        .leaderboard-user img {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            margin-right: 0.75rem;
            flex-shrink: 0;
        }

        .leaderboard-wager,
        .leaderboard-profit {
            width: 22.5%;
            text-align: left;
            display: flex;
            align-items: center;
            justify-content: flex-start;
            font-weight: 500;
            font-size: 1.1rem;
            color: #F1F1F1;
        }

        .leaderboard-profit.negative {
            color: #FF4040;
        }

        .leaderboard-wager i,
        .leaderboard-profit i {
            margin-right: 0.25rem;
            color: #8A8D99;
        }
    </style>
</head>
<body class="bg-blackest-night text-off-white min-h-screen flex flex-col">

    <!-- Top Navigation Bar -->
    <nav class="bg-eclipse p-4 flex items-center justify-between shadow-xl rounded-b-xl mx-4 mt-4 border-b border-border-dark">
        <div class="flex items-center space-x-6">
            <div class="flex items-center space-x-3">
                <img src="https://placehold.co/48x48/C040FF/FFFFFF?text=BX" alt="BloxyX Logo" class="rounded-full shadow-lg border-2 border-cyber-candy">
                <span class="text-4xl font-extrabold text-cyber-candy tracking-wider">BloxyX</span>
            </div>
            <a href="#" class="text-steel-mist hover:text-cyber-candy px-4 py-2 rounded-lg transition-all duration-300 flex items-center space-x-2 text-xl font-semibold">
                <i class="fas fa-home text-2xl"></i>
                <span>Home</span>
            </a>
            <a href="#" id="leaderboardButton" class="text-steel-mist hover:text-sky-pulse px-4 py-2 rounded-lg transition-all duration-300 flex items-center space-x-2 text-xl font-semibold">
                <i class="fas fa-trophy text-2xl"></i>
                <span>Leaderboard</span>
            </a>
        </div>
        <div class="flex items-center space-x-4">
            <button id="walletButton" class="bg-eclipse text-steel-mist px-7 py-3 rounded-full hover:bg-border-dark transition-colors duration-300 flex items-center space-x-2 shadow-lg transform hover:scale-105 border border-border-dark">
                <i class="fas fa-wallet text-sky-pulse text-xl"></i>
                <span id="walletBalance" class="font-bold text-xl">0</span>
            </button>
            <button class="bg-cyber-candy text-off-white px-7 py-3 rounded-full hover:bg-pulse-pink transition-colors duration-300 flex items-center space-x-2 shadow-lg transform hover:scale-105" id="loginButton">
                <i class="fas fa-sign-in-alt text-xl"></i>
                <span class="font-bold text-xl">Login</span>
            </button>
        </div>
    </nav>

    <!-- Main Content Area -->
    <div class="flex flex-grow mt-6 mx-4">
        <!-- Left Sidebar (Config & Jackpot) -->
        <aside class="w-[10%] bg-eclipse p-6 rounded-xl shadow-xl mr-6 flex flex-col justify-between items-center border border-border-dark">
            <div>
                <div class="flex flex-col items-center space-y-10">
                    <a href="coinflip.html" class="flex flex-col items-center space-y-2 cursor-pointer transition-all duration-200 group active:scale-105" style="text-decoration: none;">
                        <i class="fas fa-dice text-steel-mist text-4xl group-hover:text-sky-pulse"></i>
                        <span class="text-steel-mist text-base font-semibold group-hover:text-sky-pulse">Games</span>
                    </a>
                    <a href="aboutus.html" class="flex flex-col items-center space-y-2 cursor-pointer transition-all duration-200 group active:scale-105" style="text-decoration: none;">
                        <i class="fas fa-info-circle text-steel-mist text-4xl group-hover:text-sky-pulse"></i>
                        <span class="text-steel-mist text-base font-semibold group-hover:text-sky-pulse">About</span>
                    </a>
                    <a href="#logout" id="logoutButton" class="flex flex-col items-center space-y-2 cursor-pointer transition-all duration-200 group active:scale-105" style="text-decoration: none;">
                        <i class="fas fa-sign-out-alt text-steel-mist text-4xl group-hover:text-sky-pulse"></i>
                        <span class="text-steel-mist text-base font-semibold group-hover:text-sky-pulse">Logout</span>
                    </a>
                </div>
            </div>

            <!-- Socials and Terms of Service (Moved to the very bottom and realigned) -->
            <div class="pt-6 border-t border-border-dark w-full flex flex-col items-center space-y-6">
                <div class="flex justify-center w-full"> <!-- Centered Discord icon -->
                    <a href="https://discord.gg/e25gcs9yjX" target="_blank" rel="noopener noreferrer" class="text-steel-mist hover:text-sky-pulse transition-colors duration-200 text-4xl">
                        <i class="fab fa-discord"></i>
                    </a>
                </div>
                <a href="terms.html" class="text-steel-mist hover:text-off-white transition-colors duration-200 text-base font-semibold px-5 py-3 rounded-lg border border-border-dark hover:border-steel-mist">
                    Terms of Service
                </a>
                <div class="flex justify-center w-full"> <!-- Container for the calculator icon -->
                    <a href="fairness.html" class="text-steel-mist hover:text-sky-pulse transition-colors duration-200 text-4xl text-center">
                        <i class="fas fa-calculator"></i>
                    </a>
                </div>
            </div>
        </aside>

        <!-- Central Content Area -->
        <main class="flex-grow flex flex-col space-y-8">
            <!-- Coinflip Section -->
            <section class="bg-eclipse p-8 rounded-xl shadow-xl border border-border-dark flex flex-col items-center space-y-8">
                <h2 class="text-4xl font-extrabold text-off-white mb-4">Coinflip</h2>

                <!-- Active Coinflip Games -->
                <div class="w-full bg-blackest-night p-8 rounded-xl shadow-lg border border-border-dark space-y-6">

                    <!-- Filter Bar (Updated Layout) -->
                    <div class="filter-bar">
                        <div class="stats-container">
                            <div class="stats-item-wrapper">
                                <div class="stats-item">
                                    <span>14</span>
                                    <span>Rooms</span>
                                </div>
                            </div>
                            <div class="stats-item-wrapper">
                                <div class="stats-item">
                                    <span>538.0K</span>
                                    <span>Value</span>
                                </div>
                            </div>
                            <div class="stats-item-wrapper">
                                <div class="stats-item">
                                    <span>45</span>
                                    <span>Items</span>
                                </div>
                            </div>
                        </div>
                        <div class="flex items-center justify-end w-full">
                            <div class="button-group">
                                <button id="createGameButton" class="active">Create</button>
                                <button id="historyButton">History</button>
                            </div>
                            <div class="filter-controls">
                                <!-- Highest to Lowest Dropdown (Custom) -->
                                <div class="relative custom-dropdown">
                                    <button class="custom-dropdown-toggle" id="sortDropdownToggle">
                                        <span id="selectedSortOptionText">Highest to Lowest</span>
                                        <i class="fas fa-chevron-down custom-dropdown-arrow"></i>
                                    </button>
                                    <div class="custom-dropdown-menu hidden" id="sortDropdownMenu">
                                        <div class="custom-dropdown-item selected" data-value="highest-to-lowest">
                                            Highest to Lowest
                                        </div>
                                        <div class="custom-dropdown-item" data-value="lowest-to-highest">Lowest to Highest</div>
                                        <div class="custom-dropdown-item" data-value="oldest-first">Oldest First</div>
                                        <div class="custom-dropdown-item" data-value="newest-first">Newest First</div>
                                        <div class="custom-dropdown-item" data-value="my-games">My Games</div>
                                    </div>
                                </div>
                                <!-- All Games Dropdown (Custom) -->
                                <div class="relative custom-dropdown">
                                    <button class="custom-dropdown-toggle" id="gameDropdownToggle">
                                        <span id="selectedGameOptionText">BSGI</span>
                                        <i class="fas fa-chevron-down custom-dropdown-arrow"></i>
                                    </button>
                                    <div class="custom-dropdown-menu hidden" id="gameDropdownMenu">
                                        <div class="custom-dropdown-item selected" data-value="BSGI">
                                            BSGI
                                        </div>
                                        <div class="custom-dropdown-item" data-value="all-games">All Games</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div id="activeCoinflipGames" class="space-y-4">
                        <!-- Sample Coinflip Game Cards for Testing -->
                        <div class="coinflip-game-card">
                            <div class="player-vs-player">
                                <div class="player-avatar-container">
                                    <img src="https://placehold.co/52x52/3C60FF/FFFFFF?text=P1" alt="Player Avatar" class="player-avatar">
                                    <div class="coin-overlay heads">H</div>
                                </div>
                                <span class="vs-text">VS</span>
                                <div class="player-avatar-container opponent-placeholder">
                                    <div class="player-avatar">?</div>
                                </div>
                            </div>
                            <div class="item-display">
                                <div class="item-wrapper">
                                    <img src="https://placehold.co/64x64/C040FF/FFFFFF?text=Pet" alt="Item" class="item-image">
                                    <div class="item-tooltip">Cyber Dragon</div>
                                    <div class="item-bet-range">5.2K - 8.8K</div>
                                </div>
                                <div class="item-wrapper">
                                    <img src="https://placehold.co/64x64/6A8FFF/FFFFFF?text=Pet" alt="Item" class="item-image">
                                    <div class="item-tooltip">Neon Wolf</div>
                                </div>
                            </div>
                            <div class="bet-value">7.2K</div>
                            <div class="action-buttons-container">
                                <button class="action-button join">Join</button>
                                <button class="action-button view">View</button>
                            </div>
                        </div>
                        
                        <div class="coinflip-game-card">
                            <div class="player-vs-player">
                                <div class="player-avatar-container">
                                    <img src="https://placehold.co/52x52/C040FF/FFFFFF?text=P2" alt="Player Avatar" class="player-avatar">
                                    <div class="coin-overlay tails">T</div>
                                </div>
                                <span class="vs-text">VS</span>
                                <div class="player-avatar-container opponent-placeholder">
                                    <div class="player-avatar">?</div>
                                </div>
                            </div>
                            <div class="item-display">
                                <div class="item-wrapper">
                                    <img src="https://placehold.co/64x64/E060FF/FFFFFF?text=Pet" alt="Item" class="item-image">
                                    <div class="item-tooltip">Pulse Phoenix</div>
                                    <div class="item-bet-range">12.5K - 15.0K</div>
                                </div>
                            </div>
                            <div class="bet-value">13.8K</div>
                            <div class="action-buttons-container">
                                <button class="action-button join">Join</button>
                                <button class="action-button view">View</button>
                            </div>
                        </div>
                    </div>
                    <!-- Load More Button (for dynamic loading) -->
                    <div class="flex justify-center mt-6">
                        <button id="loadMoreGamesButton" class="bg-sky-pulse text-off-white px-8 py-3 rounded-lg hover:bg-neon-aura transition-colors duration-300 font-bold shadow-md text-lg">
                            Load More Games
                        </button>
                    </div>
                    <div id="noMoreGamesMessage" class="text-steel-mist text-center py-4 hidden">No more games to load.</div>
                </div>
            </section>

            <!-- Live Feed Section (Kept as per implicit instruction) -->
            <section class="bg-eclipse p-8 rounded-xl shadow-xl border border-border-dark">
                <h3 class="text-4xl font-bold text-off-white mb-6">Live Feed</h3>
                <div class="flex space-x-4 mb-6">
                    <button class="bg-cyber-candy text-off-white px-7 py-3 rounded-lg hover:bg-pulse-pink transition-colors duration-300 font-bold shadow-md text-lg">Live Bets</button>
                </div>
                <!-- Table Header (now a flex div) -->
                <div class="flex text-sm font-bold text-steel-mist uppercase tracking-wider mb-4 px-6">
                    <div class="w-[35%]">Player</div>
                    <div class="w-[15%] text-center">Game</div>
                    <div class="w-[20%] text-center">Bet Amount</div>
                    <div class="w-[15%] text-center">Multiplier</div>
                    <div class="w-[15%] text-center">Potential Win</div>
                </div>

                <div id="liveFeedContainer" class="space-y-3">
                    <!-- Sample Live Feed Rows -->
                    <div class="live-feed-row">
                        <div class="w-[35%] flex items-center">
                            <img src="https://placehold.co/40x40/3C60FF/FFFFFF?text=U1" alt="Player Avatar" class="w-10 h-10 rounded-lg mr-3">
                            <span class="text-off-white font-semibold">CyberGamer22</span>
                        </div>
                        <div class="w-[15%] text-center text-steel-mist font-semibold">Coinflip</div>
                        <div class="w-[20%] text-center text-off-white font-bold">5,240</div>
                        <div class="w-[15%] text-center text-green-400 font-bold">2.0x</div>
                        <div class="w-[15%] text-center text-off-white font-bold">10,480</div>
                    </div>
                    <div class="live-feed-row">
                        <div class="w-[35%] flex items-center">
                            <img src="https://placehold.co/40x40/C040FF/FFFFFF?text=U2" alt="Player Avatar" class="w-10 h-10 rounded-lg mr-3">
                            <span class="text-off-white font-semibold">NeonWarrior</span>
                        </div>
                        <div class="w-[15%] text-center text-steel-mist font-semibold">Coinflip</div>
                        <div class="w-[20%] text-center text-off-white font-bold">8,750</div>
                        <div class="w-[15%] text-center text-red-400 font-bold">0.0x</div>
                        <div class="w-[15%] text-center text-off-white font-bold">0</div>
                    </div>
                    <div class="live-feed-row">
                        <div class="w-[35%] flex items-center">
                            <img src="https://placehold.co/40x40/6A8FFF/FFFFFF?text=U3" alt="Player Avatar" class="w-10 h-10 rounded-lg mr-3">
                            <span class="text-off-white font-semibold">PixelMaster</span>
                        </div>
                        <div class="w-[15%] text-center text-steel-mist font-semibold">Coinflip</div>
                        <div class="w-[20%] text-center text-off-white font-bold">12,300</div>
                        <div class="w-[15%] text-center text-green-400 font-bold">2.0x</div>
                        <div class="w-[15%] text-center text-off-white font-bold">24,600</div>
                    </div>
                </div>
            </section>
        </main>

        <!-- Right Sidebar (Chat) -->
        <aside class="w-[18%] bg-eclipse p-6 rounded-xl shadow-xl ml-6 flex flex-col border border-border-dark h-[calc(100vh-8rem)]">
            <div class="flex items-center justify-between mb-6 flex-shrink-0">
                <h3 class="text-3xl font-bold text-off-white">Chat</h3>
                <!-- Removed chatOptionsButton -->
            </div>
            <div class="flex-1 overflow-y-auto chat-scroll-area pr-3 mb-6">
                <!-- Chat Messages -->
                <div class="space-y-4">
                    <div class="chat-message-card">
                        <div class="flex flex-col min-w-0">
                            <div class="flex items-center min-w-0">
                                <span class="relative flex-shrink-0 mr-2">
                                    <img src="https://placehold.co/40x40/3C60FF/FFFFFF?text=R" alt="User Avatar" class="rounded-lg border-2 border-sky-pulse chat-avatar">
                                </span>
                                <span class="font-semibold text-sky-pulse text-base">@roblox_magic</span>
                            </div>
                            <p class="text-steel-mist text-base mt-1 font-medium break-words">Accident</p>
                        </div>
                        <span class="text-steel-mist text-sm absolute top-3 right-4">1 min ago</span>
                    </div>
                    <div class="chat-message-card">
                        <div class="flex flex-col min-w-0">
                            <div class="flex items-center min-w-0">
                                <span class="relative flex-shrink-0 mr-2">
                                    <img src="https://placehold.co/40x40/C040FF/FFFFFF?text=E" alt="User Avatar" class="rounded-lg border-2 border-cyber-candy chat-avatar">
                                </span>
                                <span class="font-semibold text-cyber-candy text-base">@eternity41</span>
                            </div>
                            <p class="text-steel-mist text-base mt-1 font-medium break-words">can somebody tip me something?</p>
                        </div>
                        <span class="text-steel-mist text-sm absolute top-3 right-4">2 min ago</span>
                    </div>
                    <div class="chat-message-card">
                        <div class="flex flex-col min-w-0">
                            <div class="flex items-center min-w-0">
                                <span class="relative flex-shrink-0 mr-2">
                                    <img src="https://placehold.co/40x40/3C60FF/FFFFFF?text=A" alt="User Avatar" class="rounded-lg border-2 border-sky-pulse chat-avatar">
                                </span>
                                <span class="font-semibold text-sky-pulse text-base">@amorWayzn</span>
                            </div>
                            <p class="text-steel-mist text-base mt-1 font-medium break-words">@general pool toks</p>
                        </div>
                        <span class="text-steel-mist text-sm absolute top-3 right-4">3 min ago</span>
                    </div>
                    <div class="chat-message-card">
                        <div class="flex flex-col min-w-0">
                            <div class="flex items-center min-w-0">
                                <span class="relative flex-shrink-0 mr-2">
                                    <img src="https://placehold.co/40x40/C040FF/FFFFFF?text=G" alt="User Avatar" class="rounded-lg border-2 border-cyber-candy chat-avatar">
                                </span>
                                <span class="font-semibold text-cyber-candy text-base">@gimelboy10002</span>
                            </div>
                            <p class="text-steel-mist text-base mt-1 font-medium break-words">rob</p>
                        </div>
                        <span class="text-steel-mist text-sm absolute top-3 right-4">4 min ago</span>
                    </div>
                    <div class="chat-message-card">
                        <div class="flex flex-col min-w-0">
                            <div class="flex items-center min-w-0">
                                <span class="relative flex-shrink-0 mr-2">
                                    <img src="https://placehold.co/40x40/3C60FF/FFFFFF?text=R" alt="User Avatar" class="rounded-lg border-2 border-sky-pulse chat-avatar">
                                </span>
                                <span class="font-semibold text-sky-pulse text-base">@roblox_magic</span>
                            </div>
                            <p class="text-steel-mist text-base mt-1 font-medium break-words">Gomem old back on dc</p>
                        </div>
                        <span class="text-steel-mist text-sm absolute top-3 right-4">5 min ago</span>
                    </div>
                </div>
            </div>
            <!-- Chat Input -->
            <div class="flex-shrink-0">
                <!-- Online Users Count and Icon -->
                <div class="flex items-center space-x-2 mb-4">
                    <div class="w-3 h-3 bg-green-500 rounded-full online-users-pulse"></div>
                    <span class="text-steel-mist text-base font-semibold">130</span>
                    <i class="fas fa-users text-steel-mist text-xl"></i>
                </div>
                <!-- Input field with integrated icons -->
                <div class="relative flex items-center w-full rounded-lg overflow-hidden bg-blackest-night border border-border-dark">
                    <input type="text" id="chatInput" placeholder="Login to chat" class="flex-grow bg-blackest-night text-off-white px-5 py-3 focus:outline-none focus:ring-0 border-none text-base font-medium pr-12 h-12" readonly>
                    <div id="sendIconContainer" class="absolute right-0 top-0 h-full flex items-center justify-center cursor-pointer px-4 bg-sky-pulse rounded-r-lg hover:bg-neon-aura transition-colors duration-200">
                        <i class="fas fa-paper-plane text-lg text-off-white"></i>
                    </div>
                </div>
            </div>
        </aside>
    </div>

    <!-- Wallet Modal -->
    <div id="walletModal" class="modal-overlay hidden">
        <div class="wallet-card">
            <div class="wallet-header">
                <h1 class="text-3xl font-extrabold text-off-white">WALLET</h1>
                <i class="fas fa-times text-steel-mist text-xl cursor-pointer hover:text-off-white" id="closeWalletModal"></i>
            </div>

            <div class="flex items-center justify-between mb-6 space-x-4">
                <div class="relative flex-grow input-group">
                    <input type="text" id="searchInput" placeholder="Search for an item..." class="w-full bg-blackest-night text-off-white px-4 py-3 rounded-lg border border-border-dark focus:outline-none focus:ring-1 focus:ring-sky-pulse">
                    <i class="fas fa-search icon"></i>
                </div>

                <div class="dropdown-container">
                    <button id="sortDropdownButton" class="dropdown-button">
                        Highest to Lowest
                        <i class="fas fa-chevron-down ml-2"></i>
                    </button>
                    <div id="sortDropdownOptions" class="dropdown-options hidden">
                        <div data-value="highest-lowest">Highest to Lowest</div>
                        <div data-value="lowest-highest">Lowest to Highest</div>
                    </div>
                </div>

                <div class="dropdown-container">
                    <button id="gameDropdownButton" class="dropdown-button">
                        All Games
                        <i class="fas fa-chevron-down ml-2"></i>
                    </button>
                    <div id="gameDropdownOptions" class="dropdown-options hidden">
                        <div data-value="all-games">All Games</div>
                        <div data-value="bsgi">BSGI</div>
                    </div>
                </div>
            </div>

            <!-- Items grid container -->
            <div id="itemsGridContainer" class="flex-grow flex flex-col">
                <!-- Value Bar -->
                <div class="value-bar">
                    <span>Value:</span>
                    <span id="currentFilteredValueDisplay" class="value-amount">0</span>
                </div>

                <div id="itemsGrid" class="item-grid">
                    <!-- Items will be dynamically generated here -->
                </div>
            </div>

            <!-- Select All and Withdraw buttons -->
            <div class="action-buttons">
                <button id="selectAllButton">Select all</button>
                <button class="action-button deposit-button" id="depositButton">Deposit</button>
                <button class="withdraw-button" id="withdrawButton">Withdraw B$0</button>
            </div>
        </div>
    </div>

    <!-- Deposit Modal -->
    <div id="depositModal" class="modal-overlay hidden">
        <div class="deposit-modal-container">
            <div class="deposit-header">
                <h1>Deposit</h1>
                <button class="close-button" id="closeDepositModal"></button>
            </div>

            <div class="instructions">
                <p>To deposit your items, follow these steps and trade with one of our verified bots below:</p>
                
                <div class="instruction-item">
                    <div class="instruction-number">1</div>
                    <div class="instruction-text">Click "Join" to trade with one of the bots below</div>
                </div>
                
                <div class="instruction-item">
                    <div class="instruction-number">2</div>
                    <div class="instruction-text">Send your items to the bot and wait for confirmation</div>
                </div>
                
                <div class="instruction-item">
                    <div class="instruction-number">3</div>
                    <div class="instruction-text">Your balance will update automatically after the trade</div>
                </div>
            </div>

            <div class="bot-list">
                <!-- Bot Card 1: PucekGoatedFr -->
                <div class="bot-card">
                    <div class="bot-info">
                        <img src="https://tr.rbxcdn.com/30DAY-AvatarHeadshot-082F2C2BD1695CAB4F252DE1EBFE5F6D-Png/150/150/AvatarHeadshot/Webp/noFilter" alt="PucekGoatedFr Avatar" class="bot-avatar">
                        <div class="bot-details">
                            <div class="flex items-center">
                                <span class="bot-name">PucekGoatedFr</span>
                                <div class="bot-status-container">
                                    <span class="bot-status-dot online-dot"></span>
                                    <span class="status-text online-text">Online</span>
                                </div>
                            </div>
                            <span class="bot-game">BGSI</span>
                        </div>
                    </div>
                    <button class="join-button" onclick="alert('Joining PucekGoatedFr!')">Join</button>
                </div>

                <!-- Bot Card 2: ZedGoatedFr -->
                <div class="bot-card">
                    <div class="bot-info">
                        <img src="https://tr.rbxcdn.com/30DAY-AvatarHeadshot-0C8681DD9D8F8101B2E96C6F9F0C6BDD-Png/150/150/AvatarHeadshot/Webp/noFilter" alt="ZedGoatedFr Avatar" class="bot-avatar">
                        <div class="bot-details">
                            <div class="flex items-center">
                                <span class="bot-name">ZedGoatedFr</span>
                                <div class="bot-status-container">
                                    <span class="bot-status-dot online-dot"></span>
                                    <span class="status-text online-text">Online</span>
                                </div>
                            </div>
                            <span class="bot-game">BGSI</span>
                        </div>
                    </div>
                    <button class="join-button" onclick="alert('Joining ZedGoatedFr!')">Join</button>
                </div>

                <!-- Bot Card 3: TharskyGoatedFr -->
                <div class="bot-card">
                    <div class="bot-info">
                        <img src="https://tr.rbxcdn.com/30DAY-AvatarHeadshot-FE8D9ADAF612535E3A35FB208FEFE339-Png/150/150/AvatarHeadshot/Webp/noFilter" alt="TharskyGoatedFr Avatar" class="bot-avatar">
                        <div class="bot-details">
                            <div class="flex items-center">
                                <span class="bot-name">TharskyGoatedFr</span>
                                <div class="bot-status-container">
                                    <span class="bot-status-dot online-dot"></span>
                                    <span class="status-text online-text">Online</span>
                                </div>
                            </div>
                            <span class="bot-game">BGSI</span>
                        </div>
                    </div>
                    <button class="join-button" onclick="alert('Joining TharskyGoatedFr!')">Join</button>
                </div>

                <!-- Bot Card 4: Bsgi_Flip (Offline) -->
                <div class="bot-card">
                    <div class="bot-info">
                        <img src="https://tr.rbxcdn.com/30DAY-AvatarHeadshot-22F7E8D8DA06B911761129365A47481A-Png/150/150/AvatarHeadshot/Webp/noFilter" alt="Bsgi_Flip Avatar" class="bot-avatar">
                        <div class="bot-details">
                            <div class="flex items-center">
                                <span class="bot-name">Bsgi_Flip</span>
                                <div class="bot-status-container">
                                    <span class="bot-status-dot offline-dot"></span>
                                    <span class="status-text offline-text">Offline</span>
                                </div>
                            </div>
                            <span class="bot-game">BGSI</span>
                        </div>
                    </div>
                    <button class="join-button" onclick="alert('Joining Bsgi_Flip!')">Join</button>
                </div>
            </div>

            <div class="security-tip">
                <strong>Important Security Notice:</strong> Always double-check the username of any trading partner. Be aware that impersonators may use similar names or avatars to deceive you!
            </div>

            <div class="balance-footer">
            </div>
        </div>
    </div>

    <!-- Chat Rules Modal -->
    <div id="chatRulesModal" class="modal-overlay hidden">
        <div class="modal-content">
            <h3 class="text-3xl font-bold text-off-white mb-6 text-center">Chat Rules</h3>
            <ul class="list-disc list-inside text-steel-mist text-lg space-y-3 mb-8">
                <li>Be respectful to others at all times.</li>
                <li>No spamming, trolling, or advertising.</li>
                <li>Do not share personal info or ask for it.</li>
                <li>Use appropriate language; hate speech is not tolerated.</li>
                <li>Follow all community guidelines and moderator instructions.</li>
            </ul>
            <button id="understandButton" class="w-full bg-sky-pulse text-off-white px-8 py-4 rounded-lg hover:bg-neon-aura transition-colors duration-300 font-bold text-xl shadow-lg">
                I Understand
            </button>
        </div>
    </div>

    <!-- Confirmation Modal Component -->
    <div id="confirmationModal" class="modal-overlay hidden">
        <div class="confirmation-modal-content">
            <i class="fas fa-times confirmation-modal-close" id="closeConfirmationModal"></i>
            <i class="fas fa-sign-out-alt confirmation-modal-icon" id="confirmationModalIcon"></i>
            <h3 class="confirmation-modal-title" id="confirmationModalTitle">Confirm Action</h3>
            <p class="confirmation-modal-message" id="confirmationModalMessage">Are you sure you want to proceed?</p>
            <div class="flex justify-center space-x-4">
                <button class="confirmation-modal-button primary" id="confirmActionButton">Confirm</button>
                <button class="confirmation-modal-button secondary" id="cancelActionButton">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Player Profile Modal -->
    <div id="playerProfileModal" class="modal-overlay hidden">
        <div class="player-profile-modal-content flex flex-col items-center text-center">
            <i class="fas fa-times player-profile-modal-close" id="closePlayerProfileModal"></i>
            <div class="player-profile-avatar-container">
                <img src="https://placehold.co/108x108/C040FF/FFFFFF?text=U" alt="Player Avatar" class="player-profile-avatar" id="profileModalAvatar">
                <span class="player-profile-level" id="profileModalLevel">LVL 0</span>
            </div>
            <h3 class="player-profile-username" id="profileModalUsername">Player Name</h3>
            <h4 class="player-stats-heading">Player Statistics</h4>
            <div class="player-stats-grid">
                <div class="player-stat-card">
                    <i class="fas fa-gem icon"></i>
                    <span class="value" id="profileModalWager">0</span>
                    <span class="label">WAGER</span>
                </div>
                <div class="player-stat-card">
                    <i class="fas fa-gem icon"></i>
                    <span class="value" id="profileModalProfit">0</span>
                    <span class="label">PROFIT</span>
                </div>
                <div class="player-stat-card">
                    <i class="fas fa-gem icon"></i>
                    <span class="value" id="profileModalWon">0</span>
                    <span class="label">WON</span>
                </div>
                <div class="player-stat-card">
                    <i class="fas fa-gem icon"></i>
                    <span class="value" id="profileModalLost">0</span>
                    <span class="label">LOST</span>
                </div>
            </div>
            <button class="player-profile-modal-button" onclick="console.log('Send Tip clicked')">Send Tip</button>
        </div>
    </div>

    <!-- Game Details Modal -->
    <div id="gameDetailsModal" class="modal-overlay hidden">
        <div class="game-details-modal-content">
            <i class="fas fa-times player-profile-modal-close" id="closeGameDetailsModal"></i>
            <h3 class="text-3xl font-bold text-off-white mb-6 text-center">Coinflip Game Details</h3>

            <div class="game-details-players">
                <!-- Player 1 -->
                <div class="game-details-player-card">
                    <div class="game-details-player-avatar-container">
                        <img src="" alt="Player 1 Avatar" class="game-details-player-avatar" id="gameDetailsPlayer1Avatar">
                        <div class="game-details-coin-overlay" id="gameDetailsPlayer1Coin">T</div>
                    </div>
                    <span class="game-details-username" id="gameDetailsPlayer1Username"></span>
                    <span class="game-details-bet-value"><i class="fas fa-gem"></i><span id="gameDetailsPlayer1Bet"></span></span>
                </div>

                <span class="game-details-vs">VS</span>

                <!-- Player 2 -->
                <div class="game-details-player-card">
                    <div class="game-details-player-avatar-container">
                        <img src="" alt="Player 2 Avatar" class="game-details-player-avatar" id="gameDetailsPlayer2Avatar">
                        <div class="game-details-coin-overlay" id="gameDetailsPlayer2Coin">H</div>
                    </div>
                    <span class="game-details-username" id="gameDetailsPlayer2Username"></span>
                    <span class="game-details-bet-value"><i class="fas fa-gem"></i><span id="gameDetailsPlayer2Bet"></span></span>
                </div>
            </div>

            <div class="game-details-win-probability">
                <div class="probability-item heads">
                    <span class="value" id="headsWager">0</span>
                    <span class="label">Heads Wager</span>
                </div>
                <div class="probability-item heads">
                    <span class="value" id="headsWinChance">0%</span>
                    <span class="label">Heads Win %</span>
                </div>
                <div class="probability-item tails">
                    <span class="value" id="tailsWager">0</span>
                    <span class="label">Tails Wager</span>
                </div>
                <div class="probability-item tails">
                    <span class="value" id="tailsWinChance">0%</span>
                    <span class="label">Tails Win %</span>
                </div>
            </div>

            <div class="game-details-items-section">
                <!-- Player 1 Items -->
                <div class="game-details-items-column">
                    <h4 id="gameDetailsPlayer1ItemsTitle">Your Items</h4>
                    <div id="gameDetailsPlayer1Items" class="w-full">
                        <!-- Items will be dynamically loaded here -->
                    </div>
                </div>

                <!-- Player 2 Items -->
                <div class="game-details-items-column">
                    <h4 id="gameDetailsPlayer2ItemsTitle">Opponent's Items</h4>
                    <div id="gameDetailsPlayer2Items" class="w-full">
                        <!-- Items will be dynamically loaded here -->
                    </div>
                </div>
            </div>

            <button class="game-details-fairness-button" id="fairnessVerifiedButton">Fairness Verified</button>
        </div>
    </div>

    <!-- Fairness Modal -->
    <div id="fairnessModal" class="modal-overlay hidden">
        <div class="fairness-modal-content">
            <i class="fas fa-times fairness-modal-close" id="closeFairnessModal"></i>
            <h3>Coinflip Fairness</h3>

            <div class="fairness-seed-item">
                <label for="gameIdSeed">GAME ID</label>
                <div class="fairness-seed-input-group">
                    <input type="text" id="gameIdSeed" class="fairness-seed-input" readonly>
                    <button class="fairness-copy-button" onclick="copyToClipboard('gameIdSeed')">Copy</button>
                </div>
            </div>

            <div class="fairness-seed-item">
                <label for="randomSeed">RANDOM SEED</label>
                <div class="fairness-seed-input-group">
                    <input type="text" id="randomSeed" class="fairness-seed-input" readonly>
                    <button class="fairness-copy-button" onclick="copyToClipboard('randomSeed')">Copy</button>
                </div>
            </div>

            <div class="fairness-seed-item">
                <label for="hashedServerSeed">HASHED SERVER SEED</label>
                <div class="fairness-seed-input-group">
                    <input type="text" id="hashedServerSeed" class="fairness-seed-input" readonly>
                    <button class="fairness-copy-button" onclick="copyToClipboard('hashedServerSeed')">Copy</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Item Selection Modal (Used for both Create and Join) -->
    <div id="itemSelectionModal" class="modal-overlay hidden">
        <div class="item-selection-modal-content">
            <i class="fas fa-times player-profile-modal-close" id="closeItemSelectionModal"></i>
            <h3 class="text-3xl font-bold text-off-white mb-6 text-center" id="itemSelectionModalTitle">Create Coinflip Game</h3>

            <!-- Coin Side Selection (Only for Create Game) -->
            <div id="coinSideSelection" class="coin-side-selection hidden">
                <div class="coin-option" data-side="Heads">H</div>
                <div class="coin-option" data-side="Tails">T</div>
            </div>

            <!-- Bet Range Display (Only for Join Game) -->
            <p id="itemSelectionBetRange" class="item-selection-modal-bet-range hidden">
                Bet Range: <span id="minBetAmount"></span> - <span id="maxBetAmount"></span>
            </p>

            <!-- Filter Bar for Pets -->
            <div class="filter-bar">
                <div class="flex items-center flex-grow mr-4 rounded-lg bg-blackest-night border border-border-dark">
                    <input type="text" id="petSearchInput" placeholder="Search for an item..." class="search-input">
                    <i class="fas fa-search search-icon mr-3"></i>
                </div>
                <!-- Highest to Lowest Dropdown (Custom) -->
                <div class="relative custom-dropdown mr-4">
                    <button class="custom-dropdown-toggle" id="petSortDropdownToggle">
                        <span id="selectedPetSortOptionText">Highest to Lowest</span>
                        <i class="fas fa-chevron-down custom-dropdown-arrow"></i>
                    </button>
                    <div class="custom-dropdown-menu hidden" id="petSortDropdownMenu">
                        <div class="custom-dropdown-item selected" data-value="highest-to-lowest">
                            Highest to Lowest
                        </div>
                        <div class="custom-dropdown-item" data-value="lowest-to-highest">Lowest to Highest</div>
                        <div class="custom-dropdown-item" data-value="oldest-first">Oldest First</div>
                        <div class="custom-dropdown-item" data-value="newest-first">Newest First</div>
                    </div>
                </div>
                <!-- All Games Dropdown (Custom) -->
                <div class="relative custom-dropdown">
                    <button class="custom-dropdown-toggle" id="petTypeDropdownToggle">
                        <span id="selectedPetTypeOptionText">All Pets</span>
                        <i class="fas fa-chevron-down custom-dropdown-arrow"></i>
                    </button>
                    <div class="custom-dropdown-menu hidden" id="petTypeDropdownMenu">
                        <div class="custom-dropdown-item selected" data-value="all-pets">
                            All Pets
                        </div>
                        <div class="custom-dropdown-item" data-value="common">Common</div>
                        <div class="custom-dropdown-item" data-value="rare">Rare</div>
                        <div class="custom-dropdown-item" data-value="epic">Epic</div>
                        <div class="custom-dropdown-item" data-value="legendary">Legendary</div>
                    </div>
                </div>
            </div>

            <div class="item-selection-modal-total-value">
                Value: <i class="fas fa-gem"></i><span id="selectedPetsTotalValue">0</span>
            </div>

            <div id="petsGrid" class="pets-grid">
                <!-- Pet items will be dynamically loaded here -->
            </div>

            <div class="item-selection-modal-buttons">
                <button class="deposit-button" id="itemSelectionDepositButton">Deposit</button>
                <button class="action-button" id="itemSelectionActionButton">Create</button>
            </div>
        </div>
    </div>


    <script>
        const chatInput = document.getElementById('chatInput');
        const sendIconContainer = document.getElementById('sendIconContainer');
        const chatRulesModal = document.getElementById('chatRulesModal');
        const understandButton = document.getElementById('understandButton');
        const liveFeedContainer = document.getElementById('liveFeedContainer');
        const walletBalanceSpan = document.getElementById('walletBalance'); // Get the wallet balance span
        const historyButton = document.getElementById('historyButton'); // Get the history button
        const createGameButton = document.getElementById('createGameButton'); // Get the create game button
        const loadMoreGamesButton = document.getElementById('loadMoreGamesButton'); // Get the load more games button
        const noMoreGamesMessage = document.getElementById('noMoreGamesMessage'); // Get the no more games message

        // Wallet elements
        const walletButton = document.getElementById('walletButton');
        const walletModal = document.getElementById('walletModal');
        const closeWalletModal = document.getElementById('closeWalletModal');

        // Deposit elements
        const depositModal = document.getElementById('depositModal');
        const closeDepositModal = document.getElementById('closeDepositModal');

        // Confirmation Modal elements
        const confirmationModal = document.getElementById('confirmationModal');
        const closeConfirmationModal = document.getElementById('closeConfirmationModal');
        const confirmActionButton = document.getElementById('confirmActionButton');
        const cancelActionButton = document.getElementById('cancelActionButton');
        const confirmationModalIcon = document.getElementById('confirmationModalIcon');
        const confirmationModalTitle = document.getElementById('confirmationModalTitle');
        const confirmationModalMessage = document.getElementById('confirmationModalMessage');

        // Player Profile Modal elements
        const playerProfileModal = document.getElementById('playerProfileModal');
        const closePlayerProfileModal = document.getElementById('closePlayerProfileModal');
        const profileModalAvatar = document.getElementById('profileModalAvatar');
        const profileModalLevel = document.getElementById('profileModalLevel');
        const profileModalUsername = document.getElementById('profileModalUsername');
        const profileModalWager = document.getElementById('profileModalWager');
        const profileModalProfit = document.getElementById('profileModalProfit');
        const profileModalWon = document.getElementById('profileModalWon');
        const profileModalLost = document.getElementById('profileModalLost');

        // Game Details Modal elements
        const gameDetailsModal = document.getElementById('gameDetailsModal');
        const closeGameDetailsModal = document.getElementById('closeGameDetailsModal');
        const gameDetailsPlayer1Avatar = document.getElementById('gameDetailsPlayer1Avatar');
        const gameDetailsPlayer1Coin = document.getElementById('gameDetailsPlayer1Coin');
        const gameDetailsPlayer1Username = document.getElementById('gameDetailsPlayer1Username');
        const gameDetailsPlayer1Bet = document.getElementById('gameDetailsPlayer1Bet');
        const gameDetailsPlayer2Avatar = document.getElementById('gameDetailsPlayer2Avatar');
        const gameDetailsPlayer2Coin = document.getElementById('gameDetailsPlayer2Coin');
        const gameDetailsPlayer2Username = document.getElementById('gameDetailsPlayer2Username');
        const gameDetailsPlayer2Bet = document.getElementById('gameDetailsPlayer2Bet');
        const gameDetailsPlayer1Items = document.getElementById('gameDetailsPlayer1Items');
        const gameDetailsPlayer2Items = document.getElementById('gameDetailsPlayer2Items');
        const gameDetailsPlayer1ItemsTitle = document.getElementById('gameDetailsPlayer1ItemsTitle');
        const gameDetailsPlayer2ItemsTitle = document.getElementById('gameDetailsPlayer2ItemsTitle');
        const fairnessVerifiedButton = document.getElementById('fairnessVerifiedButton');
        const headsWagerSpan = document.getElementById('headsWager');
        const headsWinChanceSpan = document.getElementById('headsWinChance');
        const tailsWagerSpan = document.getElementById('tailsWager');
        const tailsWinChanceSpan = document.getElementById('tailsWinChance');

        // Fairness Modal elements
        const fairnessModal = document.getElementById('fairnessModal');
        const closeFairnessModal = document.getElementById('closeFairnessModal');
        const gameIdSeedInput = document.getElementById('gameIdSeed');
        const randomSeedInput = document.getElementById('randomSeed');
        const hashedServerSeedInput = document.getElementById('hashedServerSeed');

        // Item Selection Modal elements (reused for both Create and Join)
        const itemSelectionModal = document.getElementById('itemSelectionModal');
        const closeItemSelectionModal = document.getElementById('closeItemSelectionModal');
        const itemSelectionModalTitle = document.getElementById('itemSelectionModalTitle');
        const itemSelectionBetRange = document.getElementById('itemSelectionBetRange');
        const minBetAmountSpan = document.getElementById('minBetAmount');
        const maxBetAmountSpan = document.getElementById('maxBetAmount');
        const petSearchInput = document.getElementById('petSearchInput');
        const petSortDropdownToggle = document.getElementById('petSortDropdownToggle');
        const petSortDropdownMenu = document.getElementById('petSortDropdownMenu');
        const selectedPetSortOptionText = document.getElementById('selectedPetSortOptionText');
        const petSortDropdownItems = petSortDropdownMenu ? petSortDropdownMenu.querySelectorAll('.custom-dropdown-item') : [];
        const petTypeDropdownToggle = document.getElementById('petTypeDropdownToggle');
        const petTypeDropdownMenu = document.getElementById('petTypeDropdownMenu');
        const selectedPetTypeOptionText = document.getElementById('selectedPetTypeOptionText');
        const petTypeDropdownItems = petTypeDropdownMenu ? petTypeDropdownMenu.querySelectorAll('.custom-dropdown-item') : [];
        const selectedPetsTotalValue = document.getElementById('selectedPetsTotalValue');
        const petsGrid = document.getElementById('petsGrid');
        const itemSelectionDepositButton = document.getElementById('itemSelectionDepositButton');
        const itemSelectionActionButton = document.getElementById('itemSelectionActionButton');
        const coinSideSelection = document.getElementById('coinSideSelection');
        const coinOptions = coinSideSelection ? coinSideSelection.querySelectorAll('.coin-option') : [];


        // Store the current action to be confirmed
        let currentConfirmationAction = null;
        let currentGameDetails = null; // To store the game data for the details modal
        let selectedPetItems = []; // To store selected pets for create/join game modal
        let currentModalMode = 'create'; // 'create' or 'join'
        let selectedCoinSide = 'Heads'; // Default coin side for creator

        // Custom Dropdown Elements (main page)
        const sortDropdownToggle = document.getElementById('sortDropdownToggle');
        const sortDropdownMenu = document.getElementById('sortDropdownMenu');
        const selectedSortOptionText = document.getElementById('selectedSortOptionText');
        const sortDropdownItems = sortDropdownMenu ? sortDropdownMenu.querySelectorAll('.custom-dropdown-item') : [];

        const gameDropdownToggle = document.getElementById('gameDropdownToggle');
        const gameDropdownMenu = document.getElementById('gameDropdownMenu');
        const selectedGameOptionText = document.getElementById('selectedGameOptionText');
        const gameDropdownItems = gameDropdownMenu ? gameDropdownMenu.querySelectorAll('.custom-dropdown-item') : [];


        // Function to show confirmation modal
        function showConfirmationModal(config) {
            confirmationModalIcon.className = `fas ${config.icon} confirmation-modal-icon`;
            confirmationModalTitle.textContent = config.title;
            confirmationModalMessage.textContent = config.message;
            confirmActionButton.textContent = config.confirmText;
            currentConfirmationAction = config.action;
            confirmationModal.classList.remove('hidden');
        }

        // Function to show player profile modal
        function showPlayerProfileModal(playerData) {
            profileModalAvatar.src = playerData.avatar;
            profileModalLevel.textContent = playerData.level;
            profileModalUsername.textContent = playerData.username || playerData.name || 'Unknown Player';
            profileModalWager.textContent = formatNumber(playerData.wager);
            profileModalProfit.textContent = formatNumber(playerData.profit);
            profileModalWon.textContent = formatNumber(playerData.won);
            profileModalLost.textContent = formatNumber(playerData.lost);
            playerProfileModal.classList.remove('hidden');
        }

        // Function to show game details modal
        function showGameDetailsModal(gameData) {
            currentGameDetails = gameData; // Store current game data

            // Player 1 details (always "Your Items" for the current player)
            gameDetailsPlayer1Avatar.src = gameData.player.avatar;
            gameDetailsPlayer1Coin.textContent = gameData.player.coinSide.charAt(0);
            gameDetailsPlayer1Coin.className = `game-details-coin-overlay ${gameData.player.coinSide.toLowerCase()}`;
            gameDetailsPlayer1Username.textContent = gameData.player.name;
            gameDetailsPlayer1Bet.textContent = formatNumber(gameData.player.totalItemsValue);
            gameDetailsPlayer1ItemsTitle.textContent = `Your Items`; // Changed to "Your Items"

            // Player 2 (opponent) details
            // If opponent hasn't joined, show placeholder
            if (!gameData.opponent.isJoined) {
                gameDetailsPlayer2Avatar.src = 'https://placehold.co/90x90/15161B/8A8D99?text=?'; // Placeholder for unjoined
                gameDetailsPlayer2Coin.textContent = gameData.opponent.coinSide.charAt(0);
                gameDetailsPlayer2Coin.className = `game-details-coin-overlay ${gameData.opponent.coinSide.toLowerCase()}`;
                gameDetailsPlayer2Username.textContent = 'Waiting...';
                gameDetailsPlayer2Bet.textContent = formatNumber(gameData.opponent.totalItemsValue);
                gameDetailsPlayer2ItemsTitle.textContent = `Opponent's Items`;
            } else {
                gameDetailsPlayer2Avatar.src = gameData.opponent.avatar;
                gameDetailsPlayer2Coin.textContent = gameData.opponent.coinSide.charAt(0);
                gameDetailsPlayer2Coin.className = `game-details-coin-overlay ${gameData.opponent.coinSide.toLowerCase()}`;
                gameDetailsPlayer2Username.textContent = gameData.opponent.name;
                gameDetailsPlayer2Bet.textContent = formatNumber(gameData.opponent.totalItemsValue);
                gameDetailsPlayer2ItemsTitle.textContent = `${gameData.opponent.name}'s Items`;
            }

            // Calculate total wager and win percentages
            const player1Value = gameData.player.totalItemsValue;
            const player2Value = gameData.opponent.totalItemsValue;
            const totalWager = player1Value + player2Value;

            let headsTotalWager = 0;
            let tailsTotalWager = 0;

            if (gameData.player.coinSide === 'Heads') {
                headsTotalWager += player1Value;
            } else {
                tailsTotalWager += player1Value;
            }

            if (gameData.opponent.isJoined) {
                if (gameData.opponent.coinSide === 'Heads') {
                    headsTotalWager += player2Value;
                } else {
                    tailsTotalWager += player2Value;
                }
            }

            const headsWinChance = totalWager > 0 ? ((headsTotalWager / totalWager) * 100).toFixed(2) : 0;
            const tailsWinChance = totalWager > 0 ? ((tailsTotalWager / totalWager) * 100).toFixed(2) : 0;

            headsWagerSpan.textContent = formatNumber(headsTotalWager);
            headsWinChanceSpan.textContent = `${headsWinChance}%`;
            tailsWagerSpan.textContent = formatNumber(tailsTotalWager);
            tailsWinChanceSpan.textContent = `${tailsWinChance}%`;


            // Render items for Player 1
            gameDetailsPlayer1Items.innerHTML = '';
            if (gameData.player.items && gameData.player.items.length > 0) {
                gameData.player.items.forEach(item => {
                    const itemDiv = document.createElement('div');
                    itemDiv.className = 'game-details-item';
                    itemDiv.innerHTML = `
                        <img src="${item.img}" alt="${item.name}">
                        <div class="game-details-item-info">
                            <div class="game-details-item-name">${item.name}</div>
                            <div class="game-details-item-value"><i class="fas fa-gem"></i>${formatNumber(item.value)}</div>
                        </div>
                    `;
                    gameDetailsPlayer1Items.appendChild(itemDiv);
                });
            } else {
                gameDetailsPlayer1Items.innerHTML = '<p class="text-steel-mist text-center">No items wagered.</p>';
            }

            // Render items for Player 2 (opponent)
            gameDetailsPlayer2Items.innerHTML = '';
            if (gameData.opponent.items && gameData.opponent.items.length > 0 && gameData.opponent.isJoined) {
                gameData.opponent.items.forEach(item => {
                    const itemDiv = document.createElement('div');
                    itemDiv.className = 'game-details-item';
                    itemDiv.innerHTML = `
                        <img src="${item.img}" alt="${item.name}">
                        <div class="game-details-item-info">
                            <div class="game-details-item-name">${item.name}</div>
                            <div class="game-details-item-value"><i class="fas fa-gem"></i>${formatNumber(item.value)}</div>
                        </div>
                    `;
                    gameDetailsPlayer2Items.appendChild(itemDiv);
                });
            } else {
                gameDetailsPlayer2Items.innerHTML = '<p class="text-steel-mist text-center">Waiting for opponent to join...</p>';
            }


            gameDetailsModal.classList.remove('hidden');
        }

        // Function to show fairness modal
        function showFairnessModal(gameData) {
            gameIdSeedInput.value = gameData.id;
            // Seeds are empty until opponent joins
            randomSeedInput.value = gameData.opponent.isJoined ? gameData.randomSeed : '';
            hashedServerSeedInput.value = gameData.opponent.isJoined ? gameData.hashedServerSeed : '';
            fairnessModal.classList.remove('hidden');
        }

        // Function to copy text to clipboard
        function copyToClipboard(elementId) {
            const inputElement = document.getElementById(elementId);
            inputElement.select();
            document.execCommand('copy');
            // You could add a small visual feedback here, e.g., a "Copied!" message
            console.log(`Copied: ${inputElement.value}`);
        }
        window.copyToClipboard = copyToClipboard; // Make it globally accessible for inline onclick

        // Function to format numbers with K, M, B suffixes
        function formatNumber(num) {
            if (typeof num !== 'number') return num; // Return as is if not a number
            if (num >= 1000000000) {
                return (num / 1000000000).toFixed(1).replace(/\.0$/, '') + 'B';
            }
            if (num >= 1000000) {
                return (num / 1000000).toFixed(1).replace(/\.0$/, '') + 'M';
            }
            if (num >= 1000) {
                return (num / 1000).toFixed(1).replace(/\.0$/, '') + 'K';
            }
            return num.toString();
        }

        // Function to fetch and display wallet balance
        async function fetchWalletBalance() {
            try {
                // Mocking a fetch call to market.json
                const response = await new Promise(resolve => {
                    setTimeout(() => {
                        resolve({
                            ok: true,
                            json: () => Promise.resolve({
                                balance: 123456 // Example dynamic balance
                            })
                        });
                    }, 300); // Simulate network delay
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                const data = await response.json();
                walletBalanceSpan.textContent = formatNumber(data.balance); // Format number for display
            } catch (error) {
                console.error('Error fetching wallet balance:', error);
                walletBalanceSpan.textContent = 'Error';
            }
        }

        // Function to fetch and display live feed data
        async function fetchLiveFeed() {
            liveFeedContainer.innerHTML = '<div class="text-steel-mist text-center py-4">Loading live feed...</div>';
            try {
                // Mocking a fetch call to mainpage.json
                const response = await new Promise(resolve => {
                    setTimeout(() => {
                        resolve({
                            ok: true,
                            json: () => Promise.resolve({
                                liveFeed: [
                                    {
                                        "player": "Rinehart0007",
                                        "timeAgo": "2s ago",
                                        "avatarPlaceholder": "R",
                                        "avatarColor": "3C60FF",
                                        "game": "Coinflip",
                                        "betAmount": 68500,
                                        "multiplier": "x1.00",
                                        "potentialWin": 68500
                                    },
                                    {
                                        "player": "Illumina",
                                        "timeAgo": "4s ago",
                                        "avatarPlaceholder": "I",
                                        "avatarColor": "C040FF",
                                        "game": "Coinflip",
                                        "betAmount": 1700,
                                        "multiplier": "x1.00",
                                        "potentialWin": 1700
                                    },
                                    {
                                        "player": "gamerboy739302",
                                        "timeAgo": "6s ago",
                                        "avatarPlaceholder": "G",
                                        "avatarColor": "3C60FF",
                                        "game": "Coinflip",
                                        "betAmount": 34500,
                                        "multiplier": "x2.00",
                                        "potentialWin": 69000
                                    },
                                    {
                                        "player": "Corey_yessss",
                                        "timeAgo": "10s ago",
                                        "avatarPlaceholder": "C",
                                        "avatarColor": "C040FF",
                                        "game": "Coinflip",
                                        "betAmount": 120,
                                        "multiplier": "x2.00",
                                        "potentialWin": 240
                                    },
                                    {
                                        "player": "Bob0c",
                                        "timeAgo": "12s ago",
                                        "avatarPlaceholder": "B",
                                        "avatarColor": "3C60FF",
                                        "game": "Coinflip",
                                        "betAmount": 58500,
                                        "multiplier": "x2.00",
                                        "potentialWin": 117000
                                    },
                                    {
                                        "player": "Rinehart0007",
                                        "timeAgo": "15s ago",
                                        "avatarPlaceholder": "R",
                                        "avatarColor": "C040FF",
                                        "game": "Coinflip",
                                        "betAmount": 55000,
                                        "multiplier": "x2.00",
                                        "potentialWin": 110000
                                    }
                                ]
                            })
                        });
                    }, 500); // Simulate network delay
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                const data = await response.json();
                renderLiveFeed(data.liveFeed);
            } catch (error) {
                console.error('Error fetching live feed:', error);
                liveFeedContainer.innerHTML = '<div class="text-red-400 text-center py-4">Failed to load live feed.</div>';
            }
        }

        // Function to render live feed data
        function renderLiveFeed(feedData) {
            liveFeedContainer.innerHTML = ''; // Clear loading message
            feedData.forEach(item => {
                const row = document.createElement('div');
                row.className = `live-feed-row hover:bg-blackest-night transition-colors duration-200`;
                row.innerHTML = `
                    <div class="flex items-center w-[35%]">
                        <div class="relative mr-4">
                            <img src="https://placehold.co/36x36/${item.avatarColor}/FFFFFF?text=${item.avatarPlaceholder}" alt="Roblox Avatar" class="rounded-full bg-steel-mist">
                        </div>
                        <div>
                            <div class="text-off-white font-bold text-lg">${item.player}</div>
                            <div class="text-steel-mist text-sm">${item.timeAgo}</div>
                        </div>
                    </div>
                    <div class="w-[15%] text-steel-mist text-center text-lg">${item.game}</div>
                    <div class="w-[20%] text-off-white text-center text-lg">
                        <i class="fas fa-gem text-sky-pulse mr-2 text-base"></i>${formatNumber(item.betAmount)}
                    </div>
                    <div class="w-[15%] text-sky-pulse font-semibold text-center text-lg">${item.multiplier}</div>
                    <div class="w-[15%] text-off-white text-center text-lg">
                        <i class="fas fa-gem text-sky-pulse mr-2 text-base"></i>${formatNumber(item.potentialWin)}
                    </div>
                `;
                liveFeedContainer.appendChild(row);
            });
        }

        // Function to add a chat message with dynamic avatar visibility
        function addChatMessage(username, message, avatarPlaceholder, avatarColor) {
            const chatMessagesContainer = document.querySelector('.chat-scroll-area .space-y-4');
            const messageCard = document.createElement('div');
            messageCard.className = 'chat-message-card';

            const avatarContainer = document.createElement('div');
            avatarContainer.className = 'relative mr-3 flex-shrink-0';
            const avatarImg = document.createElement('img');
            avatarImg.src = `https://placehold.co/40x40/${avatarColor}/FFFFFF?text=${avatarPlaceholder}`;
            avatarImg.alt = 'User Avatar';
            avatarImg.className = 'rounded-lg border-2 border-sky-pulse chat-avatar';
            avatarContainer.appendChild(avatarImg);

            const messageContentWrapper = document.createElement('div');
            messageContentWrapper.className = 'flex-grow min-w-0'; // flex-grow and min-w-0 for wrapping

            const usernameSpan = document.createElement('span');
            usernameSpan.className = `font-semibold text-${avatarColor === '3C60FF' ? 'sky-pulse' : 'cyber-candy'} text-base`;
            usernameSpan.textContent = `@${username}`;

            const messageP = document.createElement('p');
            messageP.className = 'text-steel-mist text-base mt-1 font-medium break-words'; // break-words for long words
            messageP.textContent = message;

            messageContentWrapper.appendChild(usernameSpan);
            messageContentWrapper.appendChild(messageP);

            const timestampSpan = document.createElement('span');
            timestampSpan.className = 'text-steel-mist text-sm absolute top-3 right-4';
            timestampSpan.textContent = 'Just now'; // Simplified for dynamic messages

            messageCard.appendChild(avatarContainer);
            messageCard.appendChild(messageContentWrapper);
            messageCard.appendChild(timestampSpan);

            chatMessagesContainer.prepend(messageCard); // Add new message to the top

            // Scroll to the bottom to show the new message
            chatMessagesContainer.scrollTop = chatMessagesContainer.scrollHeight;
        }

        // Wallet data and functionality
        const allWalletItems = [
            { name: "Overlord Plushie", image: "https://www.bgsi.gg/items/overlord-plushie.png", gemValue: 80, largeValue: 4000, game: "BSGI" },
            { name: "Shiny Sword of Awesomeness", image: "https://www.bgsi.gg/items/overlord-plushie.png", gemValue: 120, largeValue: 6000, game: "All Games" },
            { name: "Legendary Shield", image: "https://www.bgsi.gg/items/overlord-plushie.png", gemValue: 70, largeValue: 3500, game: "BSGI" },
            { name: "Magic Potion", image: "https://www.bgsi.gg/items/overlord-plushie.png", gemValue: 30, largeValue: 1500, game: "All Games" },
            { name: "Rare Gemstone of Power", image: "https://www.bgsi.gg/items/overlord-plushie.png", gemValue: 200, largeValue: 10000, game: "BSGI" },
            { name: "Enchanted Bow", image: "https://www.bgsi.gg/items/overlord-plushie.png", gemValue: 90, largeValue: 4500, game: "All Games" },
            { name: "Mystic Amulet", image: "https://www.bgsi.gg/items/overlord-plushie.png", gemValue: 60, largeValue: 3000, game: "BSGI" },
            { name: "Swift Boots", image: "https://www.bgsi.gg/items/overlord-plushie.png", gemValue: 40, largeValue: 2000, game: "All Games" },
            { name: "Dragon Scale Armor", image: "https://www.bgsi.gg/items/overlord-plushie.png", gemValue: 250, largeValue: 12500, game: "BSGI" },
            { name: "Phoenix Feather", image: "https://www.bgsi.gg/items/overlord-plushie.png", gemValue: 150, largeValue: 7500, game: "All Games" },
            { name: "Glimmering Orb", image: "https://www.bgsi.gg/items/overlord-plushie.png", gemValue: 50, largeValue: 2500, game: "BSGI" },
            { name: "Ancient Scroll", image: "https://www.bgsi.gg/items/overlord-plushie.png", gemValue: 100, largeValue: 5000, game: "All Games" },
            { name: "Shadow Dagger", image: "https://www.bgsi.gg/items/overlord-plushie.png", gemValue: 110, largeValue: 5500, game: "BSGI" },
            { name: "Crystal Wand", image: "https://www.bgsi.gg/items/overlord-plushie.png", gemValue: 130, largeValue: 6500, game: "All Games" },
            { name: "Elixir of Life", image: "https://www.bgsi.gg/items/overlord-plushie.png", gemValue: 75, largeValue: 3750, game: "BSGI" },
            { name: "Titan's Gauntlet", image: "https://www.bgsi.gg/items/overlord-plushie.png", gemValue: 300, largeValue: 15000, game: "All Games" },
            { name: "Frosty Blade", image: "https://www.bgsi.gg/items/overlord-plushie.png", gemValue: 95, largeValue: 4750, game: "BSGI" },
            { name: "Inferno Staff", image: "https://www.bgsi.gg/items/overlord-plushie.png", gemValue: 180, largeValue: 9000, game: "All Games" },
            { name: "Windwalker Boots", image: "https://www.bgsi.gg/items/overlord-plushie.png", gemValue: 65, largeValue: 3250, game: "BSGI" },
            { name: "Starfall Robes", image: "https://www.bgsi.gg/items/overlord-plushie.png", gemValue: 220, largeValue: 11000, game: "All Games" },
        ];

        let currentFilteredItems = [...allWalletItems];
        let currentSortOrder = 'highest-lowest';
        let currentGameFilter = 'all-games';
        let dropdownsInitialized = false;

        // Function to calculate and display total value of currently filtered items
        function updateCurrentFilteredValueDisplay() {
            const totalValue = currentFilteredItems.reduce((sum, item) => sum + item.largeValue, 0);
            document.getElementById('currentFilteredValueDisplay').textContent = `$${totalValue.toLocaleString()}`;
        }

        // Function to render items in the grid
        function renderItems(items) {
            const itemsGrid = document.getElementById('itemsGrid');
            itemsGrid.innerHTML = ''; // Clear existing items

            if (items.length === 0) {
                itemsGrid.innerHTML = `
                    <div class="no-items-container col-span-full">
                        <p class="text-steel-mist text-lg mb-6">No items found in your inventory.</p>
                        <button class="deposit-button-large" onclick="alert('Deposit functionality would be implemented here!')">
                            Deposit
                        </button>
                    </div>
                `;
                return;
            }

            items.forEach(item => {
                const itemDiv = document.createElement('div');
                itemDiv.className = 'item-grid-item';
                itemDiv.dataset.value = item.largeValue; // Store value for selection
                itemDiv.innerHTML = `
                    <img src="${item.image}" alt="${item.name}" onerror="this.onerror=null;this.src='https://placehold.co/80x80/8A8D99/FFFFFF?text=Error';" />
                    <span class="item-name">${item.name}</span>
                    <span class="item-value"><i class="fas fa-gem"></i>${item.gemValue}</span>
                    <div class="large-value">${item.largeValue.toLocaleString()}</div>
                `;
                itemsGrid.appendChild(itemDiv);
            });
            updateSelectAllButtonText(); // Update select all button state after rendering
            updateCurrentFilteredValueDisplay(); // Update the value bar after rendering
        }

        // Function to filter and sort items
        function filterAndSortItems() {
            let filteredItems = [...allWalletItems];

            // Apply search filter
            const searchInput = document.getElementById('searchInput');
            if (searchInput) {
                const searchTerm = searchInput.value.toLowerCase();
                if (searchTerm) {
                    filteredItems = filteredItems.filter(item =>
                        item.name.toLowerCase().includes(searchTerm)
                    );
                }
            }

            // Apply game filter
            if (currentGameFilter !== 'all-games') {
                filteredItems = filteredItems.filter(item => 
                    item.game === 'BSGI' || item.game === 'All Games'
                );
            }

            // Apply sort order
            if (currentSortOrder === 'highest-lowest') {
                filteredItems.sort((a, b) => b.largeValue - a.largeValue);
            } else if (currentSortOrder === 'lowest-highest') {
                filteredItems.sort((a, b) => a.largeValue - b.largeValue);
            }

            currentFilteredItems = filteredItems; // Update the global filtered items
            renderItems(currentFilteredItems);
        }

        // Function to update the "Select all" button text
        function updateSelectAllButtonText() {
            const allItems = document.getElementById('itemsGrid').querySelectorAll('.item-grid-item');
            const selectedItems = document.getElementById('itemsGrid').querySelectorAll('.item-grid-item.selected');
            const selectAllButton = document.getElementById('selectAllButton');

            if (selectAllButton && selectedItems.length === allItems.length && allItems.length > 0) {
                selectAllButton.textContent = 'Deselect all';
            } else if (selectAllButton) {
                selectAllButton.textContent = 'Select all';
            }
        }

        // Function to update the withdraw button value
        function updateWithdrawValue() {
            const selectedItems = document.getElementById('itemsGrid').querySelectorAll('.item-grid-item.selected');
            let totalWithdrawValue = 0;
            selectedItems.forEach(item => {
                totalWithdrawValue += parseInt(item.dataset.value);
            });
            const withdrawButton = document.getElementById('withdrawButton');
            if (withdrawButton) {
                withdrawButton.textContent = `Withdraw B$${totalWithdrawValue.toLocaleString()}`;
            }
        }

        // Dropdown functionality
        function setupDropdown(buttonId, optionsId, type) {
            const button = document.getElementById(buttonId);
            const options = document.getElementById(optionsId);

            if (!button || !options) return; // Safety check

            // Only add event listeners if not already added
            if (!button.hasAttribute('data-dropdown-setup')) {
                button.setAttribute('data-dropdown-setup', 'true');
                
                button.addEventListener('click', (event) => {
                    event.stopPropagation(); // Prevent click from closing other dropdowns
                    // Close other dropdowns
                    document.querySelectorAll('.dropdown-options').forEach(otherOptions => {
                        if (otherOptions.id !== optionsId) {
                            otherOptions.classList.add('hidden');
                        }
                    });
                    options.classList.toggle('hidden');
                });

                options.querySelectorAll('div').forEach(option => {
                    option.addEventListener('click', () => {
                        button.childNodes[0].nodeValue = option.textContent + ' '; // Update button text
                        options.classList.add('hidden');
                        if (type === 'sort') {
                            currentSortOrder = option.dataset.value;
                        } else if (type === 'game') {
                            currentGameFilter = option.dataset.value;
                        }
                        filterAndSortItems(); // Re-filter and re-sort
                    });
                });

                // Close dropdown if clicked outside
                document.addEventListener('click', (event) => {
                    if (!button.contains(event.target) && !options.contains(event.target)) {
                        options.classList.add('hidden');
                    }
                });
            }
        }

        // Coinflip Game Logic
        // Mock data for active coinflip games with items and locked status
        let allMockCoinflipGames = [
            {
                id: 'game1',
                player: {
                    name: 'PlayerOne',
                    avatar: 'https://tr.rbxcdn.com/30DAY-AvatarHeadshot-B788536395A2B2D0580BDE5DCE7969C1-Png/150/150/AvatarHeadshot/Webp/noFilter',
                    coinSide: 'Tails',
                    coinColor: 'C040FF',
                    level: 'LVL 10',
                    wager: 500000,
                    profit: -10000,
                    won: 200,
                    lost: 150,
                    items: [
                        { name: 'Rare Sword', img: 'https://www.bgsi.gg/items/man-face-god.png', value: 100000 },
                        { name: 'Epic Shield', img: 'https://www.bgsi.gg/items/man-face-god.png', value: 75000 },
                        { name: 'Legendary Armor', img: 'https://www.bgsi.gg/items/man-face-god.png', value: 125000 },
                        { name: 'Health Potion', img: 'https://www.bgsi.gg/items/man-face-god.png', value: 5000 },
                        { name: 'Mana Potion', img: 'https://www.bgsi.gg/items/man-face-god.png', value: 4000 }
                    ],
                    totalItemsValue: 309000 // Sum of items
                },
                opponent: {
                    name: 'Opponent',
                    avatar: '',
                    coinSide: 'Heads',
                    coinColor: '3C60FF',
                    isJoined: false,
                    items: [], // Empty until joined
                    totalItemsValue: 330000 // Target value for opponent to match
                },
                bet: 200000, // This bet value might be redundant if using totalItemsValue
                randomSeed: 'd6db6cc758c5b7bbae67d8f9c0a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6q7r8s9',
                hashedServerSeed: 'bc25a0d0e5699098dee3f4a5b6c7d8e9f0a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5',
                locked: true,
                createdAt: Date.now()
            },
            {
                id: 'game2',
                player: {
                    name: 'GamerGirl',
                    avatar: 'https://placehold.co/150x150/C040FF/FFFFFF?text=GG',
                    coinSide: 'Heads',
                    coinColor: '3C60FF',
                    level: 'LVL 5',
                    wager: 150000,
                    profit: 5000,
                    won: 100,
                    lost: 80,
                    items: [
                        { name: 'Magic Potion', img: 'https://www.bgsi.gg/items/man-face-god.png', value: 10000 },
                        { name: 'Dragon Scale', img: 'https://www.bgsi.gg/items/man-face-god.png', value: 20000 },
                        { name: 'Fire Gem', img: 'https://www.bgsi.gg/items/man-face-god.png', value: 15000 }
                    ],
                    totalItemsValue: 45000
                },
                opponent: {
                    name: 'Opponent',
                    avatar: '',
                    coinSide: 'Tails',
                    coinColor: 'C040FF',
                    isJoined: false,
                    items: [], // Empty until joined
                    totalItemsValue: 30000 // Target value for opponent to match
                },
                bet: 99000,
                randomSeed: 'a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6q7r8s9t0u1v2w3x4y5z6a7b8c9d0e1f2',
                hashedServerSeed: 'k1l2m3n4o5p6q7r8s9t0u1v2w3x4y5z6a7b8c9d0e1f2g3h4i5j6k7l8m9n0o1p2',
                locked: false,
                createdAt: Date.now() - (10 * 60 * 1000) // 10 minutes ago
            },
            {
                id: 'game3',
                player: {
                    name: 'ProGamer',
                    avatar: 'https://placehold.co/150x150/3C60FF/FFFFFF?text=PG',
                    coinSide: 'Tails',
                    coinColor: 'C040FF',
                    level: 'LVL 20',
                    wager: 1000000,
                    profit: 50000,
                    won: 500,
                    lost: 200,
                    items: [
                        { name: 'Ancient Scroll', img: 'https://www.bgsi.gg/items/man-face-god.png', value: 300000 },
                        { name: 'Mystic Orb', img: 'https://www.bgsi.gg/items/man-face-god.png', value: 150000 }
                    ],
                    totalItemsValue: 450000
                },
                opponent: {
                    name: 'Opponent',
                    avatar: '',
                    coinSide: 'Heads',
                    coinColor: '3C60FF',
                    isJoined: false,
                    items: [], // Empty until joined
                    totalItemsValue: 120000 // Target value for opponent to match
                },
                bet: 92000,
                randomSeed: 'b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6q7r8s9t0u1v2w3x4y5z6a7b8c9d0e1f2g3',
                hashedServerSeed: 'l2m3n4o5p6q7r8s9t0u1v2w3x4y5z6a7b8c9d0e1f2g3h4i5j6k7l8m9n0o1p2q3',
                locked: false,
                createdAt: Date.now() - (20 * 60 * 1000) // 20 minutes ago
            },
            {
                id: 'game4',
                player: {
                    name: 'RobloxFan',
                    avatar: 'https://placehold.co/150x150/C040FF/FFFFFF?text=RF',
                    coinSide: 'Heads',
                    coinColor: '3C60FF',
                    level: 'LVL 2',
                    wager: 5000,
                    profit: 100,
                    won: 10,
                    lost: 5,
                    items: [
                        { name: 'Basic Axe', img: 'https://www.bgsi.gg/items/man-face-god.png', value: 5000 }
                    ],
                    totalItemsValue: 5000
                },
                opponent: {
                    name: 'Opponent',
                    avatar: '',
                    coinSide: 'Tails',
                    coinColor: 'C040FF',
                    isJoined: false,
                    items: [], // Empty until joined
                    totalItemsValue: 4500 // Target value for opponent to match
                },
                bet: 13100,
                randomSeed: 'c3d4e5f6g7h8i9j0k1l2m3n4o5p6q7r8s9t0u1v2w3x4y5z6a7b8c9d0e1f2g3h4',
                hashedServerSeed: 'm3n4o5p6q7r8s9t0u1v2w3x4y5z6a7b8c9d0e1f2g3h4i5j6k7l8m9n0o1p2q3r4',
                locked: false,
                createdAt: Date.now() - (5 * 60 * 1000) // 5 minutes ago
            },
            {
                id: 'game5',
                player: {
                    name: 'NoobMaster',
                    avatar: 'https://placehold.co/150x150/3C60FF/FFFFFF?text=NM',
                    coinSide: 'Tails',
                    coinColor: 'C040FF',
                    level: 'LVL 1',
                    wager: 2000,
                    profit: -50,
                    won: 2,
                    lost: 3,
                    items: [
                        { name: 'Wooden Staff', img: 'https://www.bgsi.gg/items/man-face-god.png', value: 8000 },
                        { name: 'Leather Boots', img: 'https://www.bgsi.gg/items/man-face-god.png', value: 12000 }
                    ],
                    totalItemsValue: 20000
                },
                opponent: {
                    name: 'Opponent',
                    avatar: '',
                    coinSide: 'Heads',
                    coinColor: '3C60FF',
                    isJoined: false,
                    items: [], // Empty until joined
                    totalItemsValue: 20000 // Target value for opponent to match
                },
                bet: 11900,
                randomSeed: 'd4e5f6g7h8i9j0k1l2m3n4o5p6q7r8s9t0u1v2w3x4y5z6a7b8c9d0e1f2g3h4i5',
                hashedServerSeed: 'n4o5p6q7r8s9t0u1v2w3x4y5z6a7b8c9d0e1f2g3h4i5j6k7l8m9n0o1p2q3r4s5',
                locked: false,
                createdAt: Date.now() - (15 * 60 * 1000) // 15 minutes ago
            },
            {
                id: 'game6',
                player: {
                    name: 'EpicGamer',
                    avatar: 'https://placehold.co/150x150/C040FF/FFFFFF?text=EG',
                    coinSide: 'Heads',
                    coinColor: '3C60FF',
                    level: 'LVL 15',
                    wager: 700000,
                    profit: 25000,
                    won: 300,
                    lost: 100,
                    items: [
                        { name: 'Shadow Cloak', img: 'https://www.bgsi.gg/items/man-face-god.png', value: 70000 },
                        { name: 'Dark Amulet', img: 'https://www.bgsi.gg/items/man-face-god.png', value: 20000 }
                    ],
                    totalItemsValue: 90000
                },
                opponent: {
                    name: 'Opponent',
                    avatar: '',
                    coinSide: 'Tails',
                    coinColor: 'C040FF',
                    isJoined: false,
                    items: [], // Empty until joined
                    totalItemsValue: 85000 // Target value for opponent to match
                },
                bet: 9000,
                randomSeed: 'e5f6g7h8i9j0k1l2m3n4o5p6q7r8s9t0u1v2w3x4y5z6a7b8c9d0e1f2g3h4i5j6',
                hashedServerSeed: 'o5p6q7r8s9t0u1v2w3x4y5z6a7b8c9d0e1f2g3h4i5j6k7l8m9n0o1p2q3r4s5t6',
                locked: false,
                createdAt: Date.now() - (25 * 60 * 1000) // 25 minutes ago
            },
            {
                id: 'game7',
                player: {
                    name: 'Legendary',
                    avatar: 'https://placehold.co/150x150/3C60FF/FFFFFF?text=L',
                    coinSide: 'Tails',
                    coinColor: 'C040FF',
                    level: 'LVL 30',
                    wager: 2000000,
                    profit: 100000,
                    won: 800,
                    lost: 300,
                    items: [
                        { name: 'Divine Relic', img: 'https://www.bgsi.gg/items/man-face-god.png', value: 500000 },
                        { name: 'Cosmic Key', img: 'https://www.bgsi.gg/items/man-face-god.png', value: 100000 }
                    ],
                    totalItemsValue: 600000
                },
                opponent: {
                    name: 'Opponent',
                    avatar: '',
                    coinSide: 'Heads',
                    coinColor: '3C60FF',
                    isJoined: false,
                    items: [], // Empty until joined
                    totalItemsValue: 550000 // Target value for opponent to match
                },
                bet: 3800,
                randomSeed: 'f6g7h8i9j0k1l2m3n4o5p6q7r8s9t0u1v2w3x4y5z6a7b8c9d0e1f2g3h4i5j6k7',
                hashedServerSeed: 'p6q7r8s9t0u1v2w3x4y5z6a7b8c9d0e1f2g3h4i5j6k7l8m9n0o1p2q3r4s5t6u7',
                locked: false,
                createdAt: Date.now() - (28 * 60 * 1000) // 28 minutes ago
            },
            {
                id: 'game8',
                player: {
                    name: 'MasterPlayer',
                    avatar: 'https://placehold.co/150x150/C040FF/FFFFFF?text=MP',
                    coinSide: 'Heads',
                    coinColor: '3C60FF',
                    level: 'LVL 25',
                    wager: 1500000,
                    profit: 75000,
                    won: 600,
                    lost: 250,
                    items: [
                        { name: 'Crystal Orb', img: 'https://www.bgsi.gg/items/man-face-god.png', value: 100000 },
                        { name: 'Enchanted Ring', img: 'https://www.bgsi.gg/items/man-face-god.png', value: 80000 }
                    ],
                    totalItemsValue: 180000
                },
                opponent: {
                    name: 'Opponent',
                    avatar: '',
                    coinSide: 'Tails',
                    coinColor: 'C040FF',
                    isJoined: false,
                    items: [], // Empty until joined
                    totalItemsValue: 170000 // Target value for opponent to match
                },
                bet: 1600,
                randomSeed: 'g7h8i9j0k1l2m3n4o5p6q7r8s9t0u1v2w3x4y5z6a7b8c9d0e1f2g3h4i5j6k7l8',
                hashedServerSeed: 'q7r8s9t0u1v2w3x4y5z6a7b8c9d0e1f2g3h4i5j6k7l8m9n0o1p2q3r4s5t6u7v8',
                locked: false,
                createdAt: Date.now() - (12 * 60 * 1000) // 12 minutes ago
            },
            {
                id: 'game9',
                player: {
                    name: 'UltimateGamer',
                    avatar: 'https://placehold.co/150x150/3C60FF/FFFFFF?text=UG',
                    coinSide: 'Tails',
                    coinColor: 'C040FF',
                    level: 'LVL 18',
                    wager: 900000,
                    profit: 40000,
                    won: 400,
                    lost: 180,
                    items: [
                        { name: 'Fire Gem', img: 'https://www.bgsi.gg/items/man-face-god.png', value: 30000 }
                    ],
                    totalItemsValue: 30000
                },
                opponent: {
                    name: 'Opponent',
                    avatar: '',
                    coinSide: 'Heads',
                    coinColor: '3C60FF',
                    isJoined: false,
                    items: [], // Empty until joined
                    totalItemsValue: 25000 // Target value for opponent to match
                },
                bet: 1200,
                randomSeed: 'h8i9j0k1l2m3n4o5p6q7r8s9t0u1v2w3x4y5z6a7b8c9d0e1f2g3h4i5j6k7l8m9',
                hashedServerSeed: 'r8s9t0u1v2w3x4y5z6a7b8c9d0e1f2g3h4i5j6k7l8m9n0o1p2q3r4s5t6u7v8w9',
                locked: false,
                createdAt: Date.now() - (8 * 60 * 1000) // 8 minutes ago
            },
            {
                id: 'game10',
                player: {
                    name: 'Newbie',
                    avatar: 'https://placehold.co/150x150/C040FF/FFFFFF?text=N',
                    coinSide: 'Heads',
                    coinColor: '3C60FF',
                    level: 'LVL 0',
                    wager: 100,
                    profit: 10,
                    won: 1,
                    lost: 0,
                    items: [
                        { name: 'Training Sword', img: 'https://www.bgsi.gg/items/man-face-god.png', value: 100 }
                    ],
                    totalItemsValue: 100
                },
                opponent: {
                    name: 'Opponent',
                    avatar: '',
                    coinSide: 'Tails',
                    coinColor: 'C040FF',
                    isJoined: false,
                    items: [], // Empty until joined
                    totalItemsValue: 90 // Target value for opponent to match
                },
                bet: 1200,
                randomSeed: 'i9j0k1l2m3n4o5p6q7r8s9t0u1v2w3x4y5z6a7b8c9d0e1f2g3h4i5j6k7l8m9n0',
                hashedServerSeed: 's9t0u1v2w3x4y5z6a7b8c9d0e1f2g3h4i5j6k7l8m9n0o1p2q3r4s5t6u7v8w9x0',
                locked: false,
                createdAt: Date.now() - (2 * 60 * 1000) // 2 minutes ago
            },
            {
                id: 'game11',
                player: {
                    name: 'NewPlayer1',
                    avatar: 'https://placehold.co/150x150/3C60FF/FFFFFF?text=NP1',
                    coinSide: 'Heads',
                    coinColor: '3C60FF',
                    level: 'LVL 3',
                    wager: 500,
                    profit: 50,
                    won: 5,
                    lost: 1,
                    items: [{ name: 'New Item A', img: 'https://www.bgsi.gg/items/man-face-god.png', value: 500 }],
                    totalItemsValue: 500
                },
                opponent: {
                    name: 'Opponent',
                    avatar: '',
                    coinSide: 'Tails',
                    coinColor: 'C040FF',
                    isJoined: false,
                    items: [], // Empty until joined
                    totalItemsValue: 480 // Target value for opponent to match
                },
                bet: 500,
                randomSeed: 'j0k1l2m3n4o5p6q7r8s9t0u1v2w3x4y5z6a7b8c9d0e1f2g3h4i5j6k7l8m9n0o1',
                hashedServerSeed: 't0u1v2w3x4y5z6a7b8c9d0e1f2g3h4i5j6k7l8m9n0o1p2q3r4s5t6u7v8w9x0y1',
                locked: false,
                createdAt: Date.now() - (18 * 60 * 1000) // 18 minutes ago
            },
            {
                id: 'game12',
                player: {
                    name: 'NewPlayer2',
                    avatar: 'https://placehold.co/150x150/C040FF/FFFFFF?text=NP2',
                    coinSide: 'Tails',
                    coinColor: 'C040FF',
                    level: 'LVL 7',
                    wager: 750,
                    profit: 100,
                    won: 8,
                    lost: 2,
                    items: [
                        { name: 'New Item B', img: 'https://www.bgsi.gg/items/man-face-god.png', value: 750 },
                        { name: 'New Item C', img: 'https://www.bgsi.gg/items/man-face-god.png', value: 600 }
                    ],
                    totalItemsValue: 1350
                },
                opponent: {
                    name: 'Opponent',
                    avatar: '',
                    coinSide: 'Heads',
                    coinColor: '3C60FF',
                    isJoined: false,
                    items: [], // Empty until joined
                    totalItemsValue: 1250 // Target value for opponent to match
                },
                bet: 750,
                randomSeed: 'k1l2m3n4o5p6q7r8s9t0u1v2w3x4y5z6a7b8c9d0e1f2g3h4i5j6k7l8m9n0o1p2',
                hashedServerSeed: 'u1v2w3x4y5z6a7b8c9d0e1f2g3h4i5j6k7l8m9n0o1p2q3r4s5t6u7v8w9x0y1z2',
                locked: false,
                createdAt: Date.now() - (22 * 60 * 1000) // 22 minutes ago
            }
        ];
        let displayedCoinflipGames = [];
        const gamesPerPage = 8; // Number of games to load per click
        let currentPage = 0;

        const activeCoinflipGamesContainer = document.getElementById('activeCoinflipGames');

        // Mock data for pets for the Create Game Modal
        const mockPetItems = [
            { id: 'pet1', name: 'Titan\'s Gauntlet', img: 'https://placehold.co/80x80/6A8FFF/FFFFFF?text=P1', value: 15000, rarity: 'legendary' },
            { id: 'pet2', name: 'Dragon Scale', img: 'https://placehold.co/80x80/C040FF/FFFFFF?text=P2', value: 12500, rarity: 'epic' },
            { id: 'pet3', name: 'Starfall Robes', img: 'https://placehold.co/80x80/3C60FF/FFFFFF?text=P3', value: 11000, rarity: 'rare' },
            { id: 'pet4', name: 'Rare Gemstone', img: 'https://placehold.co/80x80/E060FF/FFFFFF?text=P4', value: 10000, rarity: 'rare' },
            { id: 'pet5', name: 'Inferno Staff', img: 'https://placehold.co/80x80/6A8FFF/FFFFFF?text=P5', value: 8000, rarity: 'epic' },
            { id: 'pet6', name: 'Volcanic Axe', img: 'https://placehold.co/80x80/C040FF/FFFFFF?text=P6', value: 7500, rarity: 'common' },
            { id: 'pet7', name: 'Phoenix Feather', img: 'https://placehold.co/80x80/3C60FF/FFFFFF?text=P7', value: 6000, rarity: 'legendary' },
            { id: 'pet8', name: 'Ocean\'s Embrace', img: 'https://placehold.co/80x80/E060FF/FFFFFF?text=P8', value: 5500, rarity: 'rare' },
            { id: 'pet9', name: 'Forest Spirit', img: 'https://placehold.co/80x80/6A8FFF/FFFFFF?text=P9', value: 4000, rarity: 'common' },
            { id: 'pet10', name: 'Desert Wanderer', img: 'https://placehold.co/80x80/C040FF/FFFFFF?text=P10', value: 3500, rarity: 'common' },
            { id: 'pet11', name: 'Arctic Fox', img: 'https://placehold.co/80x80/3C60FF/FFFFFF?text=P11', value: 3000, rarity: 'rare' },
            { id: 'pet12', name: 'Mountain Goat', img: 'https://placehold.co/80x80/E060FF/FFFFFF?text=P12', value: 2500, rarity: 'common' },
            { id: 'pet13', name: 'Swamp Monster', img: 'https://placehold.co/80x80/6A8FFF/FFFFFF?text=P13', value: 2000, rarity: 'epic' },
            { id: 'pet14', name: 'Sky Serpent', img: 'https://placehold.co/80x80/C040FF/FFFFFF?text=P14', value: 1800, rarity: 'legendary' },
            { id: 'pet15', name: 'Cave Bat', img: 'https://placehold.co/80x80/3C60FF/FFFFFF?text=P15', value: 1500, rarity: 'common' },
            { id: 'pet16', name: 'River Dolphin', img: 'https://placehold.co/80x80/E060FF/FFFFFF?text=P16', value: 1200, rarity: 'rare' },
        ];

        // Function to filter out expired games (older than 30 minutes)
        function filterExpiredGames(games) {
            const now = Date.now();
            const thirtyMinutes = 30 * 60 * 1000;
            return games.filter(game => (now - game.createdAt) < thirtyMinutes);
        }

        function renderActiveCoinflipGames() {
            // Filter out expired games before rendering
            allMockCoinflipGames = filterExpiredGames(allMockCoinflipGames);

            // Clear existing games only if it's the first page
            if (currentPage === 0) {
                activeCoinflipGamesContainer.innerHTML = '';
                displayedCoinflipGames = []; // Reset displayed games for a fresh load
            }

            const startIndex = currentPage * gamesPerPage;
            const endIndex = startIndex + gamesPerPage;
            const gamesToRender = allMockCoinflipGames.slice(startIndex, endIndex);

            if (gamesToRender.length === 0 && currentPage === 0) {
                activeCoinflipGamesContainer.innerHTML = '<div class="text-steel-mist text-center py-4">No active games. Create one!</div>';
                loadMoreGamesButton.classList.add('hidden'); // Hide button if no games
                noMoreGamesMessage.classList.add('hidden'); // Hide "No more games" message
                return;
            } else if (gamesToRender.length === 0 && currentPage > 0) {
                // No more games to load
                loadMoreGamesButton.classList.add('hidden');
                noMoreGamesMessage.classList.remove('hidden'); // Show "No more games" message
                return;
            }

            // Hide "No more games" message if there are games to load
            noMoreGamesMessage.classList.add('hidden');

            gamesToRender.forEach(game => {
                const gameCard = document.createElement('div');
                gameCard.className = 'coinflip-game-card';

                // Player vs Player section with click event for profile modal
                const playerVsPlayer = `
                    <div class="player-vs-player">
                        <div class="player-avatar-container" data-player-id="${game.player.name}">
                            <img src="${game.player.avatar}" alt="Player Avatar" class="player-avatar">
                            <div class="coin-overlay ${game.player.coinSide.toLowerCase()}">${game.player.coinSide.charAt(0)}</div>
                        </div>
                        <span class="vs-text">VS</span>
                        <div class="player-avatar-container ${game.opponent.isJoined ? '' : 'opponent-placeholder'}" data-player-id="${game.opponent.name}" data-game-id="${game.id}">
                            ${game.opponent.avatar ? `<img src="${game.opponent.avatar}" alt="Opponent Avatar" class="player-avatar">` : `<div class="player-avatar bg-eclipse rounded-full flex items-center justify-center text-steel-mist text-2xl"><i class="fas fa-question"></i></div>`}
                            <div class="coin-overlay ${game.opponent.coinSide.toLowerCase()}">${game.opponent.coinSide.charAt(0)}</div>
                        </div>
                    </div>
                `;

                // Item display with hoverable tooltips and stacking
                // Ensure game.player.items is an array before slicing
                const playerItems = Array.isArray(game.player.items) ? game.player.items : [];
                const displayedItems = playerItems.slice(0, 3); // Show first 3 items from player's items
                const remainingItemsCount = playerItems.length - displayedItems.length;

                const itemDisplay = `
                    <div class="item-display">
                        ${displayedItems.map((item) => `
                            <div class="item-wrapper">
                                <img src="${item.img}" alt="${item.name}" class="item-image">
                                <span class="item-tooltip">${item.name}</span>
                            </div>
                        `).join('')}
                        ${remainingItemsCount > 0 ? `
                            <div class="item-wrapper">
                                <img src="${playerItems[3] ? playerItems[3].img : 'https://placehold.co/64x64/15161B/8A8D99?text=+'}" alt="More Items" class="item-image blurred">
                                <span class="item-overlay-text">+${remainingItemsCount}</span>
                                <span class="item-tooltip">More Items</span>
                            </div>
                        ` : ''}
                        <span class="item-bet-range w-full text-center mt-2">${formatNumber(game.player.totalItemsValue)} - ${formatNumber(game.opponent.totalItemsValue)}</span>
                    </div>
                `;

                const betValue = `
                    <div class="bet-value">
                        <i class="fas fa-gem text-sky-pulse mr-1"></i>${formatNumber(game.bet)}
                    </div>
                `;

                // Conditional rendering for Join/View buttons
                const actionButtons = game.locked ? `
                    <div class="action-buttons-container">
                        <button class="action-button view" data-game-id="${game.id}" onclick="handleViewGame('${game.id}')">View</button>
                    </div>
                ` : `
                    <div class="action-buttons-container">
                        <button class="action-button join" data-game-id="${game.id}" data-min-bet="${game.player.totalItemsValue * 0.9}" data-max-bet="${game.player.totalItemsValue * 1.1}" onclick="handleJoinGame('${game.id}')">
                            Join
                        </button>
                        <button class="action-button view" data-game-id="${game.id}" onclick="handleViewGame('${game.id}')">View</button>
                    </div>
                `;

                gameCard.innerHTML = playerVsPlayer + itemDisplay + betValue + actionButtons;
                activeCoinflipGamesContainer.appendChild(gameCard);
            });

            displayedCoinflipGames = displayedCoinflipGames.concat(gamesToRender);

            // Hide "Load More" button if all games are displayed
            if (displayedCoinflipGames.length >= allMockCoinflipGames.length) {
                loadMoreGamesButton.classList.add('hidden');
                if (allMockCoinflipGames.length > 0) { // Only show "No more games" if there were games to begin with
                    noMoreGamesMessage.classList.remove('hidden');
                }
            } else {
                loadMoreGamesButton.classList.remove('hidden');
                noMoreGamesMessage.classList.add('hidden');
            }

            // Add event listeners for player profile clicks after rendering games
            document.querySelectorAll('.player-avatar-container').forEach(container => {
                const gameId = container.dataset.gameId;
                const game = allMockCoinflipGames.find(g => g.id === gameId);

                // Check if it's the opponent placeholder and if they haven't joined
                if (container.classList.contains('opponent-placeholder') && (!game || !game.opponent.isJoined)) {
                    // Do not add click listener for unjoined opponents
                    return;
                }

                container.addEventListener('click', (event) => {
                    const playerId = event.currentTarget.dataset.playerId;
                    let playerFound = null;
                    for (const game of allMockCoinflipGames) {
                        if (game.player.name === playerId) {
                            playerFound = game.player;
                            break;
                        } else if (game.opponent.name === playerId && game.opponent.isJoined) {
                            // If it's the opponent and they have joined, provide their mock data
                            playerFound = {
                                username: game.opponent.name,
                                avatar: game.opponent.avatar, // Use opponent's actual avatar if joined
                                level: 'LVL Y', // Placeholder for opponent level
                                wager: Math.floor(Math.random() * 100000), // Random mock data
                                profit: Math.floor(Math.random() * 5000) - 2500,
                                won: Math.floor(Math.random() * 50),
                                lost: Math.floor(Math.random() * 30)
                            };
                            break;
                        }
                    }

                    if (playerFound) {
                        showPlayerProfileModal(playerFound);
                    } else {
                        console.warn('Player data not found or opponent not yet joined for:', playerId);
                    }
                });
            });
        }

        // Function to handle joining a game
        function handleJoinGame(gameId) {
            currentModalMode = 'join';
            const game = allMockCoinflipGames.find(g => g.id === gameId);
            if (!game) {
                console.error('Game not found for joining:', gameId);
                return;
            }

            itemSelectionModalTitle.textContent = 'Pick your items to join';
            itemSelectionActionButton.textContent = 'Join';
            itemSelectionActionButton.onclick = () => {
                const totalValue = selectedPetItems.reduce((sum, item) => sum + item.value, 0);
                const minBet = game.player.totalItemsValue * 0.9;
                const maxBet = game.player.totalItemsValue * 1.1;

                if (selectedPetItems.length === 0) {
                    alert('Please select at least one pet to join the game.');
                    return;
                }
                if (totalValue < minBet || totalValue > maxBet) {
                    alert(`Your selected items value (${formatNumber(totalValue)}) is not within the acceptable range (${formatNumber(minBet)} - ${formatNumber(maxBet)}).`);
                    return;
                }

                console.log(`Joined game ${gameId} with items worth ${formatNumber(totalValue)}`);
                // Find the game and mark the opponent as joined
                const gameIndex = allMockCoinflipGames.findIndex(g => g.id === gameId);
                if (gameIndex !== -1) {
                    allMockCoinflipGames[gameIndex].opponent.isJoined = true;
                    // For demonstration, let's assign a generic avatar and items to the joined opponent
                    allMockCoinflipGames[gameIndex].opponent.avatar = 'https://tr.rbxcdn.com/30DAY-AvatarHeadshot-B788536395A2B2D0580BDE5DCE7969C1-Png/150/150/AvatarHeadshot/Webp/noFilter';
                    allMockCoinflipGames[gameIndex].opponent.name = 'JoinedOpponent'; // Assign a name
                    allMockCoinflipGames[gameIndex].opponent.items = selectedPetItems; // Assign selected items to opponent
                    allMockCoinflipGames[gameIndex].opponent.totalItemsValue = totalValue;
                    // Assign the opposite coin side to the joiner
                    allMockCoinflipGames[gameIndex].opponent.coinSide = game.player.coinSide === 'Heads' ? 'Tails' : 'Heads';


                    // Re-render the games to update the clickable status
                    currentPage = 0; // Reset to first page to force a full re-render
                    renderActiveCoinflipGames();
                }
                itemSelectionModal.classList.add('hidden');
                alert('Joining game...');
            };

            // Display bet range
            itemSelectionBetRange.classList.remove('hidden');
            minBetAmountSpan.textContent = formatNumber(game.player.totalItemsValue * 0.9);
            maxBetAmountSpan.textContent = formatNumber(game.player.totalItemsValue * 1.1);
            coinSideSelection.classList.add('hidden'); // Hide coin side selection for joiner

            selectedPetItems = []; // Clear previous selections
            updateSelectedPetsValue();
            renderPetItems(); // Render all pets initially
            itemSelectionModal.classList.remove('hidden');
        }
        window.handleJoinGame = handleJoinGame; // Make it globally accessible for inline onclick

        // Function to handle viewing a game
        function handleViewGame(gameId) {
            const game = allMockCoinflipGames.find(g => g.id === gameId);
            if (game) {
                showGameDetailsModal(game);
            } else {
                console.error('Game not found:', gameId);
            }
        }
        window.handleViewGame = handleViewGame; // Make it globally accessible for inline onclick


        // --- Item Selection Modal Logic (for both Create and Join) ---
        function renderPetItems(filterText = '', sortOrder = 'highest-to-lowest', petType = 'all-pets') {
            petsGrid.innerHTML = ''; // Clear existing items
            let filteredPets = [...mockPetItems]; // Create a mutable copy

            // Filter by search text
            if (filterText) {
                const lowerCaseFilter = filterText.toLowerCase();
                filteredPets = filteredPets.filter(pet =>
                    pet.name.toLowerCase().includes(lowerCaseFilter)
                );
            }

            // Filter by pet type
            if (petType !== 'all-pets') {
                filteredPets = filteredPets.filter(pet => pet.rarity === petType);
            }

            // Sort items
            filteredPets.sort((a, b) => {
                if (sortOrder === 'highest-to-lowest') {
                    return b.value - a.value;
                } else if (sortOrder === 'lowest-to-highest') {
                    return a.value - b.value;
                }
                // For 'oldest-first' and 'newest-first', you'd need a 'createdAt' property on mockPetItems
                return 0; // No change if sort order is not recognized or not applicable
            });


            if (filteredPets.length === 0) {
                petsGrid.innerHTML = '<p class="text-steel-mist text-center py-4">No items found matching your criteria.</p>';
                return;
            }

            filteredPets.forEach(pet => {
                const petCard = document.createElement('div');
                petCard.className = `pet-item-card ${selectedPetItems.some(item => item.id === pet.id) ? 'selected' : ''}`;
                petCard.dataset.id = pet.id;
                petCard.innerHTML = `
                    <img src="${pet.img}" alt="${pet.name}">
                    <div class="item-name">${pet.name}</div>
                    <div class="item-value"><i class="fas fa-gem"></i>${formatNumber(pet.value)}</div>
                    ${selectedPetItems.some(item => item.id === pet.id) ? '<div class="selection-overlay"><i class="fas fa-check"></i></div>' : ''}
                `;
                petsGrid.appendChild(petCard);

                petCard.addEventListener('click', () => {
                    togglePetSelection(pet);
                });
            });
        }

        function togglePetSelection(pet) {
            const index = selectedPetItems.findIndex(item => item.id === pet.id);
            if (index > -1) {
                // Deselect
                selectedPetItems.splice(index, 1);
            } else {
                // Select
                selectedPetItems.push(pet);
            }
            updateSelectedPetsValue();
            renderPetItems(petSearchInput.value, selectedPetSortOptionText.dataset.value, selectedPetTypeOptionText.dataset.value); // Re-render to update selection visual
        }

        function updateSelectedPetsValue() {
            const total = selectedPetItems.reduce((sum, item) => sum + item.value, 0);
            selectedPetsTotalValue.textContent = formatNumber(total);
        }

        // Initial fetch of live feed data and wallet balance when the page loads
        document.addEventListener('DOMContentLoaded', () => {
            // Set initial wallet balance immediately
            if (walletBalanceSpan) {
                walletBalanceSpan.textContent = '1,250';
            }
            
            fetchLiveFeed();
            fetchWalletBalance();
            currentPage = 0; // Reset page for initial load
            renderActiveCoinflipGames(); // Initial render of coinflip games

            // Set up interval to filter out expired games every minute
            setInterval(() => {
                const initialGameCount = allMockCoinflipGames.length;
                allMockCoinflipGames = filterExpiredGames(allMockCoinflipGames);
                if (allMockCoinflipGames.length !== initialGameCount) {
                    // If games were removed, re-render the current page to reflect changes
                    currentPage = 0; // Reset to first page to force a full re-render
                    renderActiveCoinflipGames();
                }
            }, 60 * 1000); // Check every minute
        });

        // Removed chatOptionsButton event listener

        // Hide chat rules modal
        if (understandButton) {
            understandButton.addEventListener('click', () => {
                chatRulesModal.classList.add('hidden');
            });
        }

        // Redirect to login if chat input is clicked when read-only
        if (chatInput) {
            chatInput.addEventListener('click', () => {
                if (chatInput.readOnly) {
                    window.location.href = 'login.html';
                }
            });
        }

        // Send message on Enter key press
        if (chatInput) {
            chatInput.addEventListener('keypress', (event) => {
            if (event.key === 'Enter') {
                const message = chatInput.value.trim();
                if (message) {
                    // Example dynamic user and avatar
                    const username = "CurrentPlayer";
                    const avatarPlaceholder = "CP";
                    const avatarColor = "3C60FF"; // Example color
                    addChatMessage(username, message, avatarPlaceholder, avatarColor);
                    chatInput.value = ''; // Clear input after sending
                }
            }
        });
        }

        // Send message on send button click
        if (sendIconContainer) {
            sendIconContainer.addEventListener('click', () => {
            const message = chatInput.value.trim();
            if (message) {
                // Example dynamic user and avatar
                    const username = "CurrentPlayer";
                    const avatarPlaceholder = "CP";
                    const avatarColor = "3C60FF"; // Example color
                addChatMessage(username, message, avatarPlaceholder, avatarColor);
                chatInput.value = ''; // Clear input after sending
            }
        });
        }

        // Confirmation Modal Event Listeners
        if (closeConfirmationModal) {
            closeConfirmationModal.addEventListener('click', () => {
                confirmationModal.classList.add('hidden');
                currentConfirmationAction = null;
            });
        }

        if (cancelActionButton) {
            cancelActionButton.addEventListener('click', () => {
                confirmationModal.classList.add('hidden');
                currentConfirmationAction = null;
            });
        }

        if (confirmActionButton) {
            confirmActionButton.addEventListener('click', () => {
            if (currentConfirmationAction) {
                currentConfirmationAction();
            }
            confirmationModal.classList.add('hidden');
            currentConfirmationAction = null;
        });
        }

        // Hide modal if clicked outside (on the overlay)
        confirmationModal.addEventListener('click', (event) => {
            if (event.target === confirmationModal) {
                confirmationModal.classList.add('hidden');
                currentConfirmationAction = null;
            }
        });

        // Player Profile Modal Event Listeners
        closePlayerProfileModal.addEventListener('click', () => {
            playerProfileModal.classList.add('hidden');
        });

        playerProfileModal.addEventListener('click', (event) => {
            if (event.target === playerProfileModal) {
                playerProfileModal.classList.add('hidden');
            }
        });

        // Game Details Modal Event Listeners
        closeGameDetailsModal.addEventListener('click', () => {
            gameDetailsModal.classList.add('hidden');
        });

        gameDetailsModal.addEventListener('click', (event) => {
            if (event.target === gameDetailsModal) {
                gameDetailsModal.classList.add('hidden');
            }
        });

        // Fairness Verified Button click listener (inside Game Details Modal)
        fairnessVerifiedButton.addEventListener('click', () => {
            if (currentGameDetails) {
                showFairnessModal(currentGameDetails);
            } else {
                console.error('No game details available for fairness check.');
            }
        });

        // Fairness Modal Event Listeners
        closeFairnessModal.addEventListener('click', () => {
            fairnessModal.classList.add('hidden');
        });

        fairnessModal.addEventListener('click', (event) => {
            if (event.target === fairnessModal) {
                fairnessModal.classList.add('hidden');
            }
        });


        // Logout Button Confirmation
        const logoutButton = document.getElementById('logoutButton');
        if (logoutButton) {
            logoutButton.addEventListener('click', (e) => {
                e.preventDefault();
                showConfirmationModal({
                    icon: 'fa-sign-out-alt',
                    title: 'Log out of your account?',
                    message: "Are you sure you want to log out? You'll need to log in again to access your account.",
                    confirmText: 'Yes, log out',
                    action: () => {
                        console.log('User logged out');
                        alert('Logged out successfully!');
                    }
                });
            });
        }

        // Wallet Modal Functionality
        if (walletButton) {
            walletButton.addEventListener('click', () => {
                walletModal.classList.remove('hidden');
                filterAndSortItems(); // Initial render with filters/sort
                updateCurrentFilteredValueDisplay(); // Display initial total filtered value

                // Setup dropdowns if not already done
                if (!dropdownsInitialized) {
                    setupDropdown('sortDropdownButton', 'sortDropdownOptions', 'sort');
                    setupDropdown('gameDropdownButton', 'gameDropdownOptions', 'game');
                    dropdownsInitialized = true;
                }

                // Search input event listener (only add if not already added)
                const searchInput = document.getElementById('searchInput');
                if (searchInput && !searchInput.hasAttribute('data-search-setup')) {
                    searchInput.setAttribute('data-search-setup', 'true');
                    searchInput.addEventListener('input', filterAndSortItems);
                }

                // Select All functionality (only add if not already added)
                const selectAllButton = document.getElementById('selectAllButton');
                if (selectAllButton && !selectAllButton.hasAttribute('data-select-setup')) {
                    selectAllButton.setAttribute('data-select-setup', 'true');
                    
                    selectAllButton.addEventListener('click', () => {
                        const itemsGrid = document.getElementById('itemsGrid');
                        const allItems = itemsGrid.querySelectorAll('.item-grid-item');
                        let allSelected = true;

                        // Check if all *displayed* items are already selected
                        allItems.forEach(item => {
                            if (!item.classList.contains('selected')) {
                                allSelected = false;
                            }
                        });

                        if (allSelected) {
                            // If all are selected, deselect all
                            allItems.forEach(item => {
                                item.classList.remove('selected');
                            });
                        } else {
                            // If not all are selected, select all
                            allItems.forEach(item => {
                                item.classList.add('selected');
                            });
                        }
                        updateSelectAllButtonText();
                        updateWithdrawValue();
                    });
                }

                // Individual item selection (use event delegation)
                const itemsGrid = document.getElementById('itemsGrid');
                if (itemsGrid && !itemsGrid.hasAttribute('data-items-setup')) {
                    itemsGrid.setAttribute('data-items-setup', 'true');
                    
                    itemsGrid.addEventListener('click', (event) => {
                        const item = event.target.closest('.item-grid-item');
                        if (item) {
                            item.classList.toggle('selected');
                            updateSelectAllButtonText();
                            updateWithdrawValue();
                        }
                    });
                }

                // Deposit button functionality (only add if not already added)
                const depositButton = document.getElementById('depositButton');
                if (depositButton && !depositButton.hasAttribute('data-deposit-setup')) {
                    depositButton.setAttribute('data-deposit-setup', 'true');
                    
                    depositButton.addEventListener('click', () => {
                        walletModal.classList.add('hidden');
                        depositModal.classList.remove('hidden');
                    });
                }
            });
        }

        // Hide wallet modal
        if (closeWalletModal) {
            closeWalletModal.addEventListener('click', () => {
                walletModal.classList.add('hidden');
            });
        }

        // Hide wallet modal when clicking outside
        if (walletModal) {
            walletModal.addEventListener('click', (event) => {
                if (event.target === walletModal) {
                    walletModal.classList.add('hidden');
                }
            });
        }

        // Deposit Modal Functionality
        if (closeDepositModal) {
            closeDepositModal.addEventListener('click', () => {
                depositModal.classList.add('hidden');
            });
        }

        // Hide deposit modal when clicking outside
        if (depositModal) {
            depositModal.addEventListener('click', (event) => {
                if (event.target === depositModal) {
                    depositModal.classList.add('hidden');
                }
            });
        }

        // Login Button - Redirect to login page
        const loginButton = document.getElementById('loginButton');
        if (loginButton) {
            loginButton.addEventListener('click', (e) => {
                e.preventDefault();
                window.location.href = 'login.html';
            });
        }

        // History Button Click
        if (historyButton) {
            historyButton.addEventListener('click', () => {
                showConfirmationModal({
                    icon: 'fa-history',
                    title: 'View Game History?',
                    message: 'You are about to view your past game history. This action cannot be undone.',
                    confirmText: 'Yes, View History',
                    action: () => {
                        console.log('Viewing game history...');
                        alert('Viewing game history!');
                    }
                });
            });
        }

        // Load More Games Button (for dynamic loading)
        if (loadMoreGamesButton) {
            loadMoreGamesButton.addEventListener('click', () => {
                currentPage++;
                renderActiveCoinflipGames();
            });
        }

        // Create Game Button (opens item selection modal in create mode)
        if (createGameButton) {
            createGameButton.addEventListener('click', () => {
            currentModalMode = 'create';
            itemSelectionModalTitle.textContent = 'Create Coinflip Game';
            itemSelectionActionButton.textContent = 'Create';
            itemSelectionActionButton.onclick = () => {
                const totalValue = selectedPetItems.reduce((sum, item) => sum + item.value, 0);
                if (selectedPetItems.length === 0) {
                    alert('Please select at least one pet to create a game.');
                    return;
                }
                if (!selectedCoinSide) {
                    alert('Please select a coin side (Heads or Tails).');
                    return;
                }

                console.log(`Creating a game with selected pets worth: ${formatNumber(totalValue)} on ${selectedCoinSide} side.`);
                // Here you would send the selectedPetItems and selectedCoinSide to your backend to create a game
                itemSelectionModal.classList.add('hidden'); // Close modal after creating
            };
            itemSelectionBetRange.classList.add('hidden'); // Hide bet range for create mode
            coinSideSelection.classList.remove('hidden'); // Show coin side selection for creator

            // Reset coin side selection visual
            coinOptions.forEach(option => {
                option.classList.remove('selected');
            });
            // Select default Heads
            const defaultHeads = coinSideSelection.querySelector('[data-side="Heads"]');
            if (defaultHeads) {
                defaultHeads.classList.add('selected');
                selectedCoinSide = 'Heads';
            }


            selectedPetItems = []; // Clear previous selections
            updateSelectedPetsValue();
            renderPetItems(); // Render all pets initially
            itemSelectionModal.classList.remove('hidden');
        });
        }

        // Coin Side Selection for Creator
        coinOptions.forEach(option => {
            option.addEventListener('click', () => {
                coinOptions.forEach(opt => opt.classList.remove('selected'));
                option.classList.add('selected');
                selectedCoinSide = option.dataset.side;
                console.log('Selected coin side:', selectedCoinSide);
            });
        });


        // Close Item Selection Modal
        closeItemSelectionModal.addEventListener('click', () => {
            itemSelectionModal.classList.add('hidden');
        });

        itemSelectionModal.addEventListener('click', (event) => {
            if (event.target === itemSelectionModal) {
                itemSelectionModal.classList.add('hidden');
            }
        });

        // Item Selection Modal - Deposit Button
        itemSelectionDepositButton.addEventListener('click', () => {
            console.log('Deposit button clicked in Item Selection Modal');
            alert('Deposit functionality not implemented yet.');
        });

        // Pet Search Input
        petSearchInput.addEventListener('input', () => {
            renderPetItems(petSearchInput.value, selectedPetSortOptionText.dataset.value, selectedPetTypeOptionText.dataset.value);
        });


        // --- Custom Dropdown Logic ---
        function setupCustomDropdown(toggleElement, menuElement, selectedTextElement, items, renderFunction = null) {
            toggleElement.addEventListener('click', (event) => {
                event.stopPropagation(); // Prevent document click from closing immediately
                // Close other open dropdowns
                document.querySelectorAll('.custom-dropdown-menu').forEach(menu => {
                    if (menu !== menuElement) {
                        menu.classList.add('hidden');
                        menu.previousElementSibling.classList.remove('active'); // Remove active from its toggle
                    }
                });

                menuElement.classList.toggle('hidden');
                toggleElement.classList.toggle('active');
            });

            items.forEach(item => {
                item.addEventListener('click', (event) => {
                    event.stopPropagation(); // Prevent document click from closing immediately
                    // Remove 'selected' from all items in this specific menu
                    items.forEach(i => {
                        i.classList.remove('selected');
                        const checkIcon = i.querySelector('.fa-check');
                        if (checkIcon) {
                            checkIcon.remove();
                        }
                    });

                    // Add 'selected' to the clicked item
                    item.classList.add('selected');

                    // Update the text of the toggle button
                    selectedTextElement.textContent = item.textContent.trim(); // Use trim to clean whitespace
                    selectedTextElement.dataset.value = item.dataset.value; // Store value in dataset for filtering

                    // Add checkmark icon to the selected item
                    const newCheckIcon = document.createElement('i');
                    newCheckIcon.className = 'fas fa-check text-off-white ml-2';
                    item.appendChild(newCheckIcon);

                    menuElement.classList.add('hidden');
                    toggleElement.classList.remove('active');

                    // Trigger re-render if a render function is provided
                    if (renderFunction) {
                        renderFunction(petSearchInput.value, selectedPetSortOptionText.dataset.value, selectedPetTypeOptionText.dataset.value);
                    } else {
                        // For main page dropdowns, just log for now
                        console.log(`Selected: ${item.dataset.value}`);
                    }
                });
            });

            // Close dropdown if clicked outside
            document.addEventListener('click', (event) => {
                if (!toggleElement.contains(event.target) && !menuElement.contains(event.target)) {
                    menuElement.classList.add('hidden');
                    toggleElement.classList.remove('active');
                }
            });
        }

        // Initialize custom dropdowns (main page)
        if (sortDropdownToggle && sortDropdownMenu && selectedSortOptionText && sortDropdownItems.length > 0) {
            setupCustomDropdown(sortDropdownToggle, sortDropdownMenu, selectedSortOptionText, sortDropdownItems);
        }
        if (gameDropdownToggle && gameDropdownMenu && selectedGameOptionText && gameDropdownItems.length > 0) {
            setupCustomDropdown(gameDropdownToggle, gameDropdownMenu, selectedGameOptionText, gameDropdownItems);
        }

        // Initialize custom dropdowns (Item Selection Modal)
        if (petSortDropdownToggle && petSortDropdownMenu && selectedPetSortOptionText && petSortDropdownItems.length > 0) {
            setupCustomDropdown(petSortDropdownToggle, petSortDropdownMenu, selectedPetSortOptionText, petSortDropdownItems, renderPetItems);
        }
        if (petTypeDropdownToggle && petTypeDropdownMenu && selectedPetTypeOptionText && petTypeDropdownItems.length > 0) {
            setupCustomDropdown(petTypeDropdownToggle, petTypeDropdownMenu, selectedPetTypeOptionText, petTypeDropdownItems, renderPetItems);
        }


        // Ensure initial checkmark is set for both dropdowns on load
        document.addEventListener('DOMContentLoaded', () => {
            // For Main Sort Dropdown
            if (sortDropdownMenu) {
                const initialSortSelected = sortDropdownMenu.querySelector('.custom-dropdown-item.selected');
                if (initialSortSelected && selectedSortOptionText) {
                    const newCheckIcon = document.createElement('i');
                    newCheckIcon.className = 'fas fa-check text-off-white ml-2';
                    initialSortSelected.appendChild(newCheckIcon);
                    selectedSortOptionText.textContent = initialSortSelected.textContent.trim();
                    selectedSortOptionText.dataset.value = initialSortSelected.dataset.value;
                }
            }

            // For Main Game Dropdown
            if (gameDropdownMenu) {
                const initialGameSelected = gameDropdownMenu.querySelector('.custom-dropdown-item.selected');
                if (initialGameSelected && selectedGameOptionText) {
                    const newCheckIcon = document.createElement('i');
                    newCheckIcon.className = 'fas fa-check text-off-white ml-2';
                    initialGameSelected.appendChild(newCheckIcon);
                    selectedGameOptionText.textContent = initialGameSelected.textContent.trim();
                    selectedGameOptionText.dataset.value = initialGameSelected.dataset.value;
                }
            }

            // For Pet Sort Dropdown (Item Selection Modal)
            if (petSortDropdownMenu) {
                const initialPetSortSelected = petSortDropdownMenu.querySelector('.custom-dropdown-item.selected');
                if (initialPetSortSelected && selectedPetSortOptionText) {
                    const newCheckIcon = document.createElement('i');
                    newCheckIcon.className = 'fas fa-check text-off-white ml-2';
                    initialPetSortSelected.appendChild(newCheckIcon);
                    selectedPetSortOptionText.textContent = initialPetSortSelected.textContent.trim();
                    selectedPetSortOptionText.dataset.value = initialPetSortSelected.dataset.value;
                }
            }

            // For Pet Type Dropdown (Item Selection Modal)
            if (petTypeDropdownMenu) {
                const initialPetTypeSelected = petTypeDropdownMenu.querySelector('.custom-dropdown-item.selected');
                if (initialPetTypeSelected && selectedPetTypeOptionText) {
                    const newCheckIcon = document.createElement('i');
                    newCheckIcon.className = 'fas fa-check text-off-white ml-2';
                    initialPetTypeSelected.appendChild(newCheckIcon);
                    selectedPetTypeOptionText.textContent = initialPetTypeSelected.textContent.trim();
                    selectedPetTypeOptionText.dataset.value = initialPetTypeSelected.dataset.value;
                }
            }
        });

        // Leaderboard data
        const leaderboardData = [
            { rank: 1, user: "BorderBandit205", avatar: "https://tr.rbxcdn.com/30DAY-AvatarHeadshot-B788536395A2B2D0580BDE5DCE7969C1-Png/150/150/AvatarHeadshot/Webp/noFilter", wager: "601.1M", profit: "5.8M" },
            { rank: 2, user: "tharskyhitter", avatar: "https://tr.rbxcdn.com/30DAY-AvatarHeadshot-B788536395A2B2D0580BDE5DCE7969C1-Png/150/150/AvatarHeadshot/Webp/noFilter", wager: "401.0M", profit: "16.0M" },
            { rank: 3, user: "Elikanroblox", avatar: "https://tr.rbxcdn.com/30DAY-AvatarHeadshot-B788536395A2B2D0580BDE5DCE7969C1-Png/150/150/AvatarHeadshot/Webp/noFilter", wager: "396.0M", profit: "6.9M" },
            { rank: 4, user: "BGS_HHA", avatar: "https://tr.rbxcdn.com/30DAY-AvatarHeadshot-B788536395A2B2D0580BDE5DCE7969C1-Png/150/150/AvatarHeadshot/Webp/noFilter", wager: "391.7M", profit: "-2.3M" },
            { rank: 5, user: "FlippingBurgers...", avatar: "https://tr.rbxcdn.com/30DAY-AvatarHeadshot-B788536395A2B2D0580BDE5DCE7969C1-Png/150/150/AvatarHeadshot/Webp/noFilter", wager: "332.2M", profit: "4.3M" },
            { rank: 6, user: "Griemmfiend", avatar: "https://tr.rbxcdn.com/30DAY-AvatarHeadshot-B788536395A2B2D0580BDE5DCE7969C1-Png/150/150/AvatarHeadshot/Webp/noFilter", wager: "258.3M", profit: "2.6M" },
            { rank: 7, user: "PlayerSeven", avatar: "https://tr.rbxcdn.com/30DAY-AvatarHeadshot-B788536395A2B2D0580BDE5DCE7969C1-Png/150/150/AvatarHeadshot/Webp/noFilter", wager: "200.0M", profit: "1.5M" },
            { rank: 8, user: "GamerEight", avatar: "https://tr.rbxcdn.com/30DAY-AvatarHeadshot-B788536395A2B2D0580BDE5DCE7969C1-Png/150/150/AvatarHeadshot/Webp/noFilter", wager: "180.0M", profit: "-0.5M" },
            { rank: 9, user: "NinthPlayer", avatar: "https://tr.rbxcdn.com/30DAY-AvatarHeadshot-B788536395A2B2D0580BDE5DCE7969C1-Png/150/150/AvatarHeadshot/Webp/noFilter", wager: "150.0M", profit: "3.0M" },
            { rank: 10, user: "TenaciousGamer", avatar: "https://tr.rbxcdn.com/30DAY-AvatarHeadshot-B788536395A2B2D0580BDE5DCE7969C1-Png/150/150/AvatarHeadshot/Webp/noFilter", wager: "120.0M", profit: "0.8M" }
        ];

        // Leaderboard functionality
        function renderLeaderboard() {
            const leaderboardList = document.getElementById('leaderboardList');
            leaderboardList.innerHTML = ''; // Clear existing content

            leaderboardData.forEach(player => {
                const row = document.createElement('div');
                row.className = 'leaderboard-row';

                // Determine profit class for styling (negative profit in red)
                const profitClass = player.profit.includes('-') ? 'negative' : '';

                // Determine color for rank and avatar border
                const rankColorClass = (player.rank % 2 === 1) ? 'rank-blue' : 'rank-pink';
                const avatarBorderClass = (player.rank % 2 === 1) ? 'border-blue' : 'border-pink';

                row.innerHTML = `
                    <div class="leaderboard-rank ${rankColorClass}">${player.rank === 1 ? '&#x2605;' : `#${player.rank}`}</div>
                    <div class="leaderboard-user">
                        <img src="${player.avatar}" alt="${player.user}'s Avatar" class="${avatarBorderClass}" onerror="this.onerror=null;this.src='https://placehold.co/48x48/8A8D99/FFFFFF?text=AV';" />
                        <span class="text-off-white font-semibold">${player.user}</span>
                    </div>
                    <div class="leaderboard-wager">
                        <i class="fas fa-coins"></i><span class="ml-2">${player.wager}</span>
                    </div>
                    <div class="leaderboard-profit ${profitClass}">
                        <i class="fas fa-coins"></i><span class="ml-2">${player.profit}</span>
                    </div>
                `;
                leaderboardList.appendChild(row);
            });
        }

        // Leaderboard Modal Event Listeners
        const leaderboardButton = document.getElementById('leaderboardButton');
        const leaderboardModal = document.getElementById('leaderboardModal');
        const closeLeaderboardModal = document.getElementById('closeLeaderboardModal');

        // Show leaderboard modal
        if (leaderboardButton) {
            leaderboardButton.addEventListener('click', (e) => {
                e.preventDefault();
                renderLeaderboard();
                leaderboardModal.classList.remove('hidden');
            });
        }

        // Hide leaderboard modal
        if (closeLeaderboardModal) {
            closeLeaderboardModal.addEventListener('click', () => {
                leaderboardModal.classList.add('hidden');
            });
        }

        // Hide leaderboard modal when clicking outside
        if (leaderboardModal) {
            leaderboardModal.addEventListener('click', (event) => {
                if (event.target === leaderboardModal) {
                    leaderboardModal.classList.add('hidden');
                }
            });
        }
    </script>

    <!-- Leaderboard Modal -->
    <div id="leaderboardModal" class="modal-overlay hidden">
        <div class="leaderboard-card">
            <div class="leaderboard-header">
                <h1 class="text-3xl font-extrabold text-off-white">LEADERBOARD</h1>
                <i class="fas fa-times text-steel-mist text-xl cursor-pointer hover:text-off-white" id="closeLeaderboardModal"></i>
            </div>

            <div class="leaderboard-table-header">
                <div class="leaderboard-rank">#</div>
                <div class="leaderboard-user">User</div>
                <div class="leaderboard-wager">Wager</div>
                <div class="leaderboard-profit">Profit</div>
            </div>

            <div id="leaderboardList">
                <!-- Leaderboard rows will be dynamically inserted here by JavaScript -->
            </div>
        </div>
    </div>

</body>
</html>
